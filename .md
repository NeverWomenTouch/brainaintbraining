local cloneref = cloneref or function(x) return x end
local function SRV(name)
    local ok, svc = pcall(game.GetService, game, name)
    if ok and svc then
        return cloneref(svc)
    end
    return nil
end
local library = {
    RainbowColorValue = 0,
    HueSelectionPosition = 0, 
    SafeCall = false, 
    Conn = {},
    Folder = "Dendrite.cc",
    LibName = "Dendrite.cc",
    animatetext = false,
    LibraryLines = true,
    debug = false,
    OCbtn = false
}
local uis = SRV("UserInputService")
local tweensv = SRV("TweenService")
local rs = SRV("RunService")
local plrs = SRV("Players")
local lp = plrs.LocalPlayer
local ms = lp:GetMouse()
local ws = SRV("Workspace")
local cam = ws.CurrentCamera
local cg = SRV("CoreGui")
local httpsv = SRV("HttpService")
local PresetColor, Drawing, placeid = Color3.fromRGB(255, 0, 0), Drawing or {}, game.PlaceId
local CloseBind, getgenv = Enum.KeyCode.X, getgenv or {}
local ProtectGui = protectgui or (syn and syn.protect_gui) or (function() end);
if getgenv().libloaded then
    for i, v in next, library.Conn do
        v:Disconnect()
    end
    for _, gui in pairs((cg or SRV("CoreGui")):GetDescendants()) do
        if gui.Name == library.LibName then
            gui:Destroy()
        end
    end
    getgenv().libloaded = false
end
getgenv().libloaded = true
local rbxgui = cg:FindFirstChild("RobloxGui") or Instance.new("ScreenGui", cg)
local screengui = Instance.new("ScreenGui", rbxgui)
ProtectGui(screengui);
screengui.Name = library.LibName
screengui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
task.spawn(function()
	while getgenv().libloaded do
		library.RainbowColorValue = library.RainbowColorValue + 1 / 255
		library.HueSelectionPosition = library.HueSelectionPosition + 1
		if library.RainbowColorValue >= 1 then
			library.RainbowColorValue = 0
		end
		if library.HueSelectionPosition == 80 then
			library.HueSelectionPosition = 0
		end
		task.wait()
	end
end)
function animateText(display, text, repeatCount, delay)
    if not display then return end
    local animatedRandom = "1234567890"
    for i = 1, #text do
        local revealChar = text:sub(i, i)
        local displayText = text:sub(1, i - 1)
        for _ = 1, math.random(1, 6) do
            local random = math.random(1, #animatedRandom)
            local randomChar = animatedRandom:sub(random, random)
            display.Text = displayText .. randomChar
            task.wait(delay)
            if library.animatetext then
                break
            end
        end
        display.Text = displayText .. revealChar
        task.wait(delay)
        if library.animatetext then
            break
        end
    end
    task.wait(5)
end
function library:Unload()
    if screengui then
        screengui:Destroy()
    end
    if cg:FindFirstChild("Show") then
        cg:FindFirstChild("Show"):Destroy()
    end
    for i,v in next, library.Conn do
		v:Disconnect()
	end
    getgenv().libloaded = false
end
function MakeDraggable(topbarobject, object)
    local Dragging = nil
    local DragInput = nil
    local DragStart = nil
    local StartPosition = nil
    local function Update(input)
        local Delta = input.Position - DragStart
        local pos =
            UDim2.new(
            StartPosition.X.Scale,
            StartPosition.X.Offset + Delta.X,
            StartPosition.Y.Scale,
            StartPosition.Y.Offset + Delta.Y
        )
        object.Position = pos
    end
    library.Conn[#library.Conn + 1] = topbarobject.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = true
            DragStart = input.Position
            StartPosition = object.Position
            library.Conn[#library.Conn + 1] = input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)
    library.Conn[#library.Conn + 1] = topbarobject.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            DragInput = input
        end
    end)
    library.Conn[#library.Conn + 1] = uis.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            Update(input)
        end
    end)
end
function library:ChangeBind(key)
	CloseBind = key
end
function library:Window(title, version, info, preset, closebind)
    CloseBind = closebind or Enum.KeyCode.RightShift
    PresetColor = preset or Color3.fromRGB(255, 0, 0)
    fs = false
    local Main = Instance.new("Frame")
    local TabHold = Instance.new("Frame")
    local TabHoldLayout = Instance.new("UIListLayout")
    local Title = Instance.new("TextLabel")
    local TabFolder = Instance.new("Folder")
    local DragFrame = Instance.new("Frame")
	local close = Instance.new("ImageButton")
    local line = Instance.new("Frame", Main)
    line.Name = "Line"
    line.Position = UDim2.new(0.28, 0, 0.1, 5)
    line.Size = UDim2.new(0, 1, 0, 270)
    line.BackgroundColor3 = PresetColor
    line.BorderColor3 = PresetColor
    line.BorderSizePixel = 0
    line.Visible = library.LibraryLines
    
    local line2 = Instance.new("Frame", Main)
    line2.Name = "Line"
    line2.Position = UDim2.new(0.6, 18, -0.5, 1)
    line2.Size = UDim2.new(0, 1, 1, 74)
    line2.Rotation = 810
    line2.BorderSizePixel = 0
    line2.BorderColor3 = PresetColor
    line2.BackgroundColor3 = PresetColor
    line2.Visible = library.LibraryLines

    local line3 = Instance.new("Frame", Main)
    line3.Name = "Line"
    line3.Position = UDim2.new(0.6, 18, -0.5, 270)
    line3.Size = UDim2.new(0, 1, 1, 75)
    line3.Rotation = 810
    line3.BorderSizePixel = 0
    line3.BorderColor3 = PresetColor
    line3.BackgroundColor3 = PresetColor
    line3.Visible = library.LibraryLines

    local line4 = Instance.new("Frame", Main)
    line4.Name = "Line"
    line4.Position = UDim2.new(1, -10, 0.1, 5)
    line4.Size = UDim2.new(0, 1, 0, 270)
    line4.BorderSizePixel = 0
    line4.BorderColor3 = PresetColor
    line4.BackgroundColor3 = PresetColor
    line4.Visible = library.LibraryLines

    Main.Name = "Main"
    Main.Parent = screengui
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    Main.BackgroundColor3 = Color3.fromRGB(1, 1, 1)
    Main.BorderSizePixel = 0
    Main.Position = UDim2.new(0.5, 0, 0.5, 0)
    Main.Size = UDim2.new(0, 560, 0, 319)
    Main.ClipsDescendants = false
    Main.Visible = true

    local boframe = Instance.new("Frame", Main)
    boframe.Name = "BorderFrame"
    boframe.AnchorPoint = Vector2.new(0.5, 0.5)
    boframe.Position = UDim2.new(0.5, 0, 0.5, 0)
    boframe.Size = UDim2.new(1, 20, 1, 20)
    boframe.BackgroundTransparency = 1
    boframe.ZIndex = 0
    boframe.ClipsDescendants = false

    local img1 = Instance.new("ImageLabel", boframe)
    img1.Name = "TopShadow"
    img1.Image = "rbxassetid://5587865193"
    img1.ImageColor3 = Color3.fromRGB(0, 0, 0)
    img1.AnchorPoint = Vector2.new(0.5, 0.5)
    img1.Position = UDim2.new(0.5, 0, 0.5, 0)
    img1.Size = UDim2.new(1.6, 0, 1.4, 0)
    img1.BackgroundTransparency = 1
    img1.ZIndex = 7

    local img2 = Instance.new("ImageLabel", boframe)
    img2.Name = "BottomShadow"
    img2.Image = "rbxassetid://5587865193"
    img2.ImageColor3 = Color3.fromRGB(0, 0, 0)
    img2.AnchorPoint = Vector2.new(0.5, 0.5)
    img2.Position = UDim2.new(0.5, 0, 0.5, 0)
    img2.Size = UDim2.new(1.6, 0, 1.4, 0)
    img2.BackgroundTransparency = 1
    img2.ZIndex = 7

    local FadeBackgroundFrame = Instance.new("Frame")

	FadeBackgroundFrame.Name = "FadeBackgroundFrame"
	FadeBackgroundFrame.Parent = Main
	FadeBackgroundFrame.BackgroundColor3 = Color3.fromRGB(27,27, 27)
	FadeBackgroundFrame.BackgroundTransparency = 1.000
	FadeBackgroundFrame.BorderSizePixel = 0
	FadeBackgroundFrame.Size = UDim2.new(1, 0, 1, 0)
	FadeBackgroundFrame.ZIndex = 3

	close.Name = "close"
    close.Parent = Main
    close.BackgroundTransparency = 1.000
    close.Position = UDim2.new(0.94, 0, 0.01, 8)
    close.Size = UDim2.new(0, 21, 0, 21)
    close.ZIndex = 2
    close.Image = "rbxassetid://3926305904"
    close.ImageRectOffset = Vector2.new(284, 4)
    close.ImageRectSize = Vector2.new(24, 24)
    close.MouseButton1Click:Connect(function()
        Main.Visible = false
    end)

    TabHold.Name = "TabHold"
    TabHold.Parent = Main
    TabHold.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    TabHold.BackgroundTransparency = 1.000
    TabHold.Position = UDim2.new(0.0339285731, 0, 0.147335425, 0)
    TabHold.Size = UDim2.new(0, 107, 0, 254)

    TabHoldLayout.Name = "TabHoldLayout"
    TabHoldLayout.Parent = TabHold
    TabHoldLayout.SortOrder = Enum.SortOrder.LayoutOrder
    TabHoldLayout.Padding = UDim.new(0, 11)

    Title.Name = "Title"
    Title.Parent = Main
    Title.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Title.BackgroundTransparency = 1.000
    Title.Position = UDim2.new(0.0339285731, 0, 0.0274263314, 0)
    Title.Size = UDim2.new(0, 200, 0, 23)
    Title.Font = Enum.Font.GothamBlack
    Title.Text = title or "Unknown Title"

    local textDisplays = {
        title,
        version,
        info
    }

    coroutine.wrap(function()
        while getgenv().libloaded do
            local repeatCount = 10
            local delay = 0.05
            for _, v in ipairs(textDisplays) do
                animateText(Title, v, repeatCount, delay)
            end
            if library.animatetext then
                Title.Text = title .. " " .. version
                break
            end
            task.wait(5)
        end
    end)()

    task.spawn(function()
        while getgenv().libloaded do
            Title.TextColor3 = PresetColor
            line.Visible = library.LibraryLines
            line2.Visible = library.LibraryLines
            line3.Visible = library.LibraryLines
            line4.Visible = library.LibraryLines
            if library.LibraryLines then
                line.BackgroundColor3 = PresetColor
                line2.BackgroundColor3 = PresetColor
                line3.BackgroundColor3 = PresetColor
                line4.BackgroundColor3 = PresetColor
            end
            task.wait()
        end
    end)

    Title.TextSize = 20
    Title.TextXAlignment = Enum.TextXAlignment.Left

    DragFrame.Name = "DragFrame"
    DragFrame.Parent = Main
    DragFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    DragFrame.BackgroundTransparency = 1.000
    DragFrame.Size = UDim2.new(0, 560, 0, 41)

    MakeDraggable(DragFrame, Main)

    library.Conn[#library.Conn + 1] = uis.InputBegan:Connect(function(io, p)
        if io.KeyCode == CloseBind then
            if Main.Visible then
                Main.Visible = false
			elseif Main.Visible == false then
                Main.Visible = true
            end
        end
    end)

	local altname = "Show"
	local ismobile = table.find({Enum.Platform.IOS, Enum.Platform.Android}, uis:GetPlatform())
    if cg:FindFirstChild("Show") then
        cg:FindFirstChild("Show"):Destroy()
    end
	if ismobile then
		if not cg:FindFirstChild(altname) then
			local ScreenGui = Instance.new("ScreenGui", cg)
			ScreenGui.Name = altname
			ScreenGui.ResetOnSpawn = false
			ScreenGui.IgnoreGuiInset = true
			ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
			
			local MobileToggleContainer = Instance.new("Frame", ScreenGui)
			MobileToggleContainer.Name = "MobileToggleContainer"
			MobileToggleContainer.BackgroundTransparency = 1
			MobileToggleContainer.Position = UDim2.new(1, -80, 0, 120)
			MobileToggleContainer.Size = UDim2.new(0, 70, 0, 70)
			MobileToggleContainer.ZIndex = 1
			
			local MobileToggle = Instance.new("Frame", MobileToggleContainer)
			MobileToggle.Name = "MobileToggle"
			MobileToggle.BackgroundColor3 = Color3.fromRGB(27, 27, 27)
			MobileToggle.BorderSizePixel = 0
			MobileToggle.Position = UDim2.new(0, 10, 0, 10)
			MobileToggle.Size = UDim2.new(0, 50, 0, 50)
			MobileToggle.ClipsDescendants = false
			MobileToggle.ZIndex = 2
			
			local MobileToggleCorner = Instance.new("UICorner")
			MobileToggleCorner.CornerRadius = UDim.new(0, 12)
			MobileToggleCorner.Parent = MobileToggle
			
			local MobileToggleStroke = Instance.new("UIStroke")
			MobileToggleStroke.Parent = MobileToggle
			MobileToggleStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
			MobileToggleStroke.Color = PresetColor
			MobileToggleStroke.Thickness = 2
			MobileToggleStroke.Transparency = 0.3
			
			local MobileToggleGlow = Instance.new("ImageLabel")
			MobileToggleGlow.Name = "Glow"
			MobileToggleGlow.Parent = MobileToggle
			MobileToggleGlow.BackgroundTransparency = 1
			MobileToggleGlow.Position = UDim2.new(0.5, -30, 0.5, -30)
			MobileToggleGlow.Size = UDim2.new(0, 60, 0, 60)
			MobileToggleGlow.Image = "rbxassetid://4996891970"
			MobileToggleGlow.ImageColor3 = PresetColor
			MobileToggleGlow.ImageTransparency = 0.7
			MobileToggleGlow.ScaleType = Enum.ScaleType.Slice
			MobileToggleGlow.SliceCenter = Rect.new(20, 20, 280, 280)
			MobileToggleGlow.ZIndex = 1
			
			local ToggleButton = Instance.new("TextButton", MobileToggle)
			ToggleButton.Name = "ToggleButton"
			ToggleButton.BackgroundTransparency = 1
			ToggleButton.Size = UDim2.new(1, 0, 1, 0)
			ToggleButton.Font = Enum.Font.Gotham
			ToggleButton.Text = ""
			ToggleButton.TextTransparency = 1
			ToggleButton.AutoButtonColor = false
			ToggleButton.ZIndex = 3
			
			local IconContainer = Instance.new("Frame")
			IconContainer.Name = "IconContainer"
			IconContainer.Parent = ToggleButton
			IconContainer.BackgroundTransparency = 1
			IconContainer.Size = UDim2.new(1, 0, 1, 0)
			IconContainer.ZIndex = 3
			
			local ToggleIcon = Instance.new("ImageLabel")
			ToggleIcon.Name = "ToggleIcon"
			ToggleIcon.Parent = IconContainer
			ToggleIcon.BackgroundTransparency = 1
			ToggleIcon.AnchorPoint = Vector2.new(0.5, 0.5)
			ToggleIcon.Position = UDim2.new(0.5, 0, 0.5, 0)
			ToggleIcon.Size = UDim2.new(0, 24, 0, 24)
			ToggleIcon.Image = "rbxassetid://109809645126775"
			ToggleIcon.ImageColor3 = Color3.fromRGB(255, 255, 255)
			ToggleIcon.ZIndex = 3
			
			local StatusIndicator = Instance.new("Frame")
			StatusIndicator.Name = "StatusIndicator"
			StatusIndicator.Parent = MobileToggle
			StatusIndicator.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
			StatusIndicator.BorderSizePixel = 0
			StatusIndicator.Position = UDim2.new(1, -12, 0, 4)
			StatusIndicator.Size = UDim2.new(0, 8, 0, 8)
			StatusIndicator.ZIndex = 4
			
			local StatusIndicatorCorner = Instance.new("UICorner")
			StatusIndicatorCorner.CornerRadius = UDim.new(1, 0)
			StatusIndicatorCorner.Parent = StatusIndicator
			
			local isHolding = false
			local isDragging = false
			local holdStartTime = 0
			local dragStartPos = nil
			
			local function updateToggleState()
				local isVisible = Main.Visible
				if isVisible then
					StatusIndicator.BackgroundColor3 = Color3.fromRGB(85, 255, 127)
					tweensv:Create(MobileToggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
						BackgroundColor3 = Color3.fromRGB(32, 42, 32)
					}):Play()
					tweensv:Create(MobileToggleStroke, TweenInfo.new(0.3), {
						Transparency = 0.1
					}):Play()
				else
					StatusIndicator.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
					tweensv:Create(MobileToggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
						BackgroundColor3 = Color3.fromRGB(27, 27, 27)
					}):Play()
					tweensv:Create(MobileToggleStroke, TweenInfo.new(0.3), {
						Transparency = 0.3
					}):Play()
				end
			end
			
			updateToggleState()
			
			task.spawn(function()
				while getgenv().libloaded and MobileToggle.Parent do
					MobileToggleStroke.Color = PresetColor
					MobileToggleGlow.ImageColor3 = PresetColor
					task.wait()
				end
			end)
			
			library.Conn[#library.Conn + 1] = ToggleButton.MouseButton1Down:Connect(function()
				isHolding = true
				holdStartTime = tick()
				
				tweensv:Create(MobileToggle, TweenInfo.new(0.1, Enum.EasingStyle.Quad), {
					Size = UDim2.new(0, 46, 0, 46),
					Position = UDim2.new(0, 12, 0, 12)
				}):Play()
				tweensv:Create(ToggleIcon, TweenInfo.new(0.1, Enum.EasingStyle.Quad), {
					Size = UDim2.new(0, 20, 0, 20)
				}):Play()
				
				spawn(function()
					task.wait(0.5)
					if isHolding then
						isDragging = true
                        local guiService = SRV("GuiService")
						local topInset = guiService:GetGuiInset().Y
						
						local mousePos = uis:GetMouseLocation()
						local adjustedMouseY = mousePos.Y - topInset
						
						local containerPos = MobileToggleContainer.AbsolutePosition
						dragStartPos = Vector2.new(mousePos.X - containerPos.X, adjustedMouseY - containerPos.Y)
					end
				end)
			end)
			
			library.Conn[#library.Conn + 1] = ToggleButton.MouseButton1Up:Connect(function()
				local holdTime = tick() - holdStartTime
				local wasQuickTap = holdTime < 0.5
				
				isHolding = false
				
				tweensv:Create(MobileToggle, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
					Size = UDim2.new(0, 50, 0, 50),
					Position = UDim2.new(0, 10, 0, 10)
				}):Play()
				tweensv:Create(ToggleIcon, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
					Size = UDim2.new(0, 24, 0, 24)
				}):Play()
				
				if isDragging then
					isDragging = false
					dragStartPos = nil
				end
				
				if wasQuickTap then
					Main.Visible = not Main.Visible
					updateToggleState()
				end
			end)
			
			library.Conn[#library.Conn + 1] = uis.InputChanged:Connect(function(input)
				if isDragging and dragStartPos and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
					local screenGui = MobileToggleContainer.Parent
					local viewport = workspace.CurrentCamera.ViewportSize
                    local guiService = SRV("GuiService")
					local topInset = guiService:GetGuiInset().Y
					
					local mousePos = uis:GetMouseLocation()
					local adjustedMouseY = mousePos.Y - topInset
					
					local containerSize = MobileToggleContainer.AbsoluteSize
					
					local newX = mousePos.X - dragStartPos.X
					local newY = adjustedMouseY - dragStartPos.Y
					
					newX = math.max(0, math.min(viewport.X - containerSize.X, newX))
					newY = math.max(0, math.min(viewport.Y - containerSize.Y, newY))
					
					MobileToggleContainer.Position = UDim2.new(0, newX, 0, newY)
				end
			end)
			
			library.Conn[#library.Conn + 1] = uis.InputEnded:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
					if isDragging then
						dragStartPos = nil
					end
				end
			end)
			
			library.Conn[#library.Conn + 1] = ToggleButton.TouchTap:Connect(function()
				if not isDragging then
					Main.Visible = not Main.Visible
					updateToggleState()
				end
			end)
			
			local pulseConnection
			pulseConnection = task.spawn(function()
				while getgenv().libloaded and MobileToggle.Parent do
					if not Main.Visible then
						tweensv:Create(MobileToggleGlow, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
							ImageTransparency = 0.5
						}):Play()
						task.wait(1.5)
						tweensv:Create(MobileToggleGlow, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
							ImageTransparency = 0.7
						}):Play()
						task.wait(1.5)
					else
						task.wait(0.5)
					end
				end
			end)
		end
	end

    TabFolder.Name = "TabFolder"
    TabFolder.Parent = Main

    function library:ChangePresetColor(toch)
        PresetColor = toch
    end

    function library:Notification(txt, desc, btn, img, timer)
        local nh = Instance.new("Frame")
        local nb = Instance.new("Frame")
        local nbg = Instance.new("UIGradient")
        local nf = Instance.new("Frame")
        local nfc = Instance.new("UICorner")
        local nfs = Instance.new("UIStroke")
        local nfg = Instance.new("ImageLabel")
        local hs = Instance.new("Frame")
        local hsc = Instance.new("UICorner")
        local ni = Instance.new("ImageLabel")
        local nt = Instance.new("TextLabel")
        local cb = Instance.new("ImageButton")
        local bs = Instance.new("Frame")
        local nd = Instance.new("TextLabel")
        local ob = Instance.new("TextButton")
        local obc = Instance.new("UICorner")
        local obs = Instance.new("UIStroke")
        local obg = Instance.new("UIGradient")
        local bt = Instance.new("TextLabel")
        local bi = Instance.new("ImageLabel")
        local la = Instance.new("Frame")
        local ra = Instance.new("Frame")
        local ba = Instance.new("Frame")
        local ta = Instance.new("Frame")
        local lg = Instance.new("ImageLabel")
        local rg = Instance.new("ImageLabel")
        local pc = Instance.new("Frame")

        nh.Name = "NotificationHolder"
        nh.Parent = Main
        nh.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        nh.BackgroundTransparency = 1
        nh.Size = UDim2.new(1, 0, 1, 0)
        nh.ZIndex = 100

        nb.Name = "NotifBackdrop"
        nb.Parent = nh
        nb.AnchorPoint = Vector2.new(0.5, 0.5)
        nb.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        nb.BackgroundTransparency = 1
        nb.Position = UDim2.new(0.5, 0, 0.5, 0)
        nb.Size = UDim2.new(1, 0, 1, 0)
        nb.ZIndex = 101

        nbg.Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 25, 25)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(10, 10, 10))
        })
        nbg.Transparency = NumberSequence.new({
            NumberSequenceKeypoint.new(0, 1),
            NumberSequenceKeypoint.new(0.5, 0.94),
            NumberSequenceKeypoint.new(1, 1)
        })
        nbg.Rotation = 90
        nbg.Parent = nb
        
        nf.Name = "NotificationFrame"
        nf.Parent = nb
        nf.AnchorPoint = Vector2.new(0.5, 0.5)
        nf.BackgroundColor3 = Color3.fromRGB(23, 23, 23)
        nf.ClipsDescendants = true
        nf.Position = UDim2.new(0.5, 0, 0.5, 0)
        nf.Size = UDim2.new(0, 0, 0, 0)
        nf.ZIndex = 102

        nfc.CornerRadius = UDim.new(0, 6)
        nfc.Name = "NotificationFrameCorner"
        nfc.Parent = nf

        nfs.Name = "NotificationFrameStroke"
        nfs.Parent = nf
        nfs.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        nfs.Color = PresetColor
        nfs.LineJoinMode = Enum.LineJoinMode.Round
        nfs.Thickness = 1.2
        nfs.Transparency = 0

        nfg.Name = "NotificationFrameGlow"
        nfg.Parent = nf
        nfg.BackgroundTransparency = 1
        nfg.BorderSizePixel = 0
        nfg.Size = UDim2.new(1, 0, 1, 0)
        nfg.ZIndex = 102
        nfg.Image = "rbxassetid://4996891970"
        nfg.ImageColor3 = Color3.fromRGB(20, 20, 20)
        nfg.ScaleType = Enum.ScaleType.Slice
        nfg.SliceCenter = Rect.new(20, 20, 280, 280)
        
        pc.Name = "ParticleContainer"
        pc.Parent = nf
        pc.BackgroundTransparency = 1
        pc.Size = UDim2.new(1, 0, 1, 0)
        pc.ClipsDescendants = true
        pc.ZIndex = 102
        
        local pts = {}
        for i = 1, 15 do
            local pt = Instance.new("Frame")
            pt.Name = "Particle" .. i
            pt.Parent = pc
            pt.BackgroundColor3 = PresetColor
            pt.BackgroundTransparency = 0.85 + (math.random() * 0.1)
            pt.Position = UDim2.new(math.random(), 0, math.random(), 0)
            pt.Size = UDim2.new(0, math.random(1, 2), 0, math.random(1, 2))
            pt.ZIndex = 102
            
            local ptc = Instance.new("UICorner")
            ptc.CornerRadius = UDim.new(1, 0)
            ptc.Parent = pt
            
            table.insert(pts, pt)
        end
        
        la.Name = "LeftAccent"
        la.Parent = nf
        la.BackgroundColor3 = PresetColor
        la.BorderSizePixel = 0
        la.Position = UDim2.new(0, 0, 0, 0)
        la.Size = UDim2.new(0, 3, 1, 0)
        la.ZIndex = 103

        ra.Name = "RightAccent"
        ra.Parent = nf
        ra.BackgroundColor3 = PresetColor
        ra.BorderSizePixel = 0
        ra.Position = UDim2.new(1, -3, 0, 0)
        ra.Size = UDim2.new(0, 3, 1, 0)
        ra.ZIndex = 103

        ta.Name = "TopAccent"
        ta.Parent = nf
        ta.BackgroundColor3 = PresetColor
        ta.BackgroundTransparency = 0.7
        ta.BorderSizePixel = 0
        ta.Position = UDim2.new(0, 0, 0, 0)
        ta.Size = UDim2.new(1, 0, 0, 1)
        ta.ZIndex = 103

        ba.Name = "BottomAccent"
        ba.Parent = nf
        ba.BackgroundColor3 = PresetColor
        ba.BackgroundTransparency = 0.7
        ba.BorderSizePixel = 0
        ba.Position = UDim2.new(0, 0, 1, -1)
        ba.Size = UDim2.new(1, 0, 0, 1)
        ba.ZIndex = 103

        lg.Name = "LeftGlow"
        lg.Parent = nf
        lg.BackgroundTransparency = 1
        lg.BorderSizePixel = 0
        lg.Position = UDim2.new(0, -15, 0.5, -40)
        lg.Size = UDim2.new(0, 30, 0, 80)
        lg.ZIndex = 103
        lg.Image = "rbxassetid://4996891970"
        lg.ImageColor3 = PresetColor
        lg.ImageTransparency = 0.9

        rg.Name = "RightGlow"
        rg.Parent = nf
        rg.BackgroundTransparency = 1
        rg.BorderSizePixel = 0
        rg.Position = UDim2.new(1, -15, 0.5, -40)
        rg.Size = UDim2.new(0, 30, 0, 80)
        rg.ZIndex = 103
        rg.Image = "rbxassetid://4996891970"
        rg.ImageColor3 = PresetColor
        rg.ImageTransparency = 0.9
        
        hs.Name = "HeaderSection"
        hs.Parent = nf
        hs.BackgroundColor3 = Color3.fromRGB(26, 26, 26)
        hs.Position = UDim2.new(0, 0, 0, 0)
        hs.Size = UDim2.new(1, 0, 0, 38)
        hs.ZIndex = 104
        
        hsc.CornerRadius = UDim.new(0, 6)
        hsc.Name = "HeaderSectionCorner"
        hsc.Parent = hs
        
        ni.Name = "NotificationIcon"
        ni.Parent = hs
        ni.AnchorPoint = Vector2.new(0, 0.5)
        ni.BackgroundTransparency = 1
        ni.Position = UDim2.new(0, 15, 0.5, 0)
        ni.Size = UDim2.new(0, 22, 0, 22)
        ni.Image = img or "rbxassetid://109809645126775"
        ni.ZIndex = 104

        nt.Name = "NotificationTitle"
        nt.Parent = hs
        nt.BackgroundTransparency = 1
        nt.Position = UDim2.new(0, 45, 0, 0)
        nt.Size = UDim2.new(1, -90, 1, 0)
        nt.Font = Enum.Font.GothamBold
        nt.Text = txt
        nt.TextColor3 = Color3.fromRGB(255, 255, 255)
        nt.TextSize = 15
        nt.TextXAlignment = Enum.TextXAlignment.Left
        nt.ZIndex = 104
        nt.MaxVisibleGraphemes = 0
        nt.RichText = true

        cb.Name = "CloseBtn"
        cb.Parent = hs
        cb.BackgroundTransparency = 1
        cb.Position = UDim2.new(1, -28, 0.5, -9)
        cb.Size = UDim2.new(0, 18, 0, 18)
        cb.ZIndex = 104
        cb.Image = "rbxassetid://7072725342"
        cb.ImageColor3 = Color3.fromRGB(180, 180, 180)
        
        bs.Name = "BodySection"
        bs.Parent = nf
        bs.BackgroundTransparency = 1
        bs.Position = UDim2.new(0, 0, 0, 38)
        bs.Size = UDim2.new(1, 0, 1, -38)
        bs.ZIndex = 104
        
        nd.Name = "NotificationDesc"
        nd.Parent = bs
        nd.BackgroundTransparency = 1
        nd.Position = UDim2.new(0, 15, 0, 10)
        nd.Size = UDim2.new(1, -30, 0, 80)
        nd.Font = Enum.Font.Gotham
        nd.Text = desc
        nd.TextColor3 = Color3.fromRGB(220, 220, 220)
        nd.TextSize = 14
        nd.TextWrapped = true
        nd.TextXAlignment = Enum.TextXAlignment.Left
        nd.TextYAlignment = Enum.TextYAlignment.Top
        nd.ZIndex = 104
        nd.MaxVisibleGraphemes = 0
        nd.RichText = true

        ob.Name = "OkayBtn"
        ob.Parent = bs
        ob.AnchorPoint = Vector2.new(0.5, 1)
        ob.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        ob.Position = UDim2.new(0.5, 0, 1, -20)
        ob.Size = UDim2.new(0, 130, 0, 36)
        ob.AutoButtonColor = false
        ob.Font = Enum.Font.SourceSans
        ob.Text = ""
        ob.ZIndex = 105

        obc.CornerRadius = UDim.new(0, 6)
        obc.Name = "OkayBtnCorner"
        obc.Parent = ob

        obs.Name = "OkayBtnStroke"
        obs.Parent = ob
        obs.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        obs.Color = PresetColor
        obs.LineJoinMode = Enum.LineJoinMode.Round
        obs.Thickness = 1
        obs.Transparency = 0.2
        
        obg.Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, Color3.fromRGB(55, 55, 55)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(45, 45, 45))
        }
        obg.Rotation = 90
        obg.Name = "OkayBtnGradient"
        obg.Parent = ob

        bt.Name = "BtnText"
        bt.Parent = ob
        bt.BackgroundTransparency = 1
        bt.Position = UDim2.new(0, 30, 0, 0)
        bt.Size = UDim2.new(1, -40, 1, 0)
        bt.Font = Enum.Font.GothamSemibold
        bt.Text = btn
        bt.TextColor3 = Color3.fromRGB(255, 255, 255)
        bt.TextSize = 14
        bt.ZIndex = 105
        bt.TextXAlignment = Enum.TextXAlignment.Left
        
        bi.Name = "BtnIcon"
        bi.Parent = ob
        bi.BackgroundTransparency = 1
        bi.Position = UDim2.new(0, 8, 0.5, -8)
        bi.Size = UDim2.new(0, 16, 0, 16)
        bi.Image = "rbxassetid://7733658504"
        bi.ImageColor3 = PresetColor
        bi.ZIndex = 105
        
        task.spawn(function()
            while getgenv().libloaded and nf.Parent do
                nfs.Color = PresetColor
                la.BackgroundColor3 = PresetColor
                ra.BackgroundColor3 = PresetColor
                ta.BackgroundColor3 = PresetColor 
                ba.BackgroundColor3 = PresetColor
                obs.Color = PresetColor
                bi.ImageColor3 = PresetColor
                lg.ImageColor3 = PresetColor
                rg.ImageColor3 = PresetColor
                
                for _, pt in ipairs(pts) do
                    pt.BackgroundColor3 = PresetColor
                end
                
                task.wait()
            end
        end)

        local ad = 0.65
        local tas = 0.012
        local fd = 0.2
        
        task.spawn(function()
            nb.BackgroundTransparency = 1
            for i = 1, 10 do
                nb.BackgroundTransparency = 1 - (i * 0.05)
                task.wait(0.01)
            end
            
            nf.Size = UDim2.new(0, 0, 0, 0)
            la.BackgroundTransparency = 1
            ra.BackgroundTransparency = 1
            ta.BackgroundTransparency = 1
            ba.BackgroundTransparency = 1
            lg.ImageTransparency = 1
            rg.ImageTransparency = 1
            nfs.Transparency = 1
            
            local st = tweensv:Create(nf, TweenInfo.new(ad, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 360, 0, 180)
            })
            
            st:Play()
            
            task.spawn(function()
                while nf.Parent do
                    for _, pt in ipairs(pts) do
                        local tx = math.random()
                        local ty = math.random()
                        local dr = 3 + (math.random() * 2)
                        
                        tweensv:Create(pt, TweenInfo.new(dr, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                            Position = UDim2.new(tx, 0, ty, 0),
                            BackgroundTransparency = 0.85 + (math.random() * 0.1),
                            Size = UDim2.new(0, math.random(1, 2), 0, math.random(1, 2))
                        }):Play()
                    end
                    task.wait(3)
                end
            end)
            
            task.wait(ad * 0.3)
            
            tweensv:Create(nfs, TweenInfo.new(fd), {
                Transparency = 0
            }):Play()
            
            task.wait(0.05)
            
            for _, ac in pairs({la, ra}) do
                ac.Size = UDim2.new(0, 3, 0, 0)
                ac.BackgroundTransparency = 0
                tweensv:Create(ac, TweenInfo.new(0.35, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
                    Size = UDim2.new(0, 3, 1, 0)
                }):Play()
            end
            
            for _, ac in pairs({ta, ba}) do
                ac.Size = UDim2.new(0, 0, 0, 1)
                ac.BackgroundTransparency = 0.7
                tweensv:Create(ac, TweenInfo.new(0.35, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
                    Size = UDim2.new(1, 0, 0, 1)
                }):Play()
            end
            
            ni:TweenPosition(UDim2.new(0, 15, 0.5, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Back, 0.3, true)
            
            task.wait(0.1)
            
            tweensv:Create(lg, TweenInfo.new(0.5), {
                ImageTransparency = 0.85
            }):Play()
            
            tweensv:Create(rg, TweenInfo.new(0.5), {
                ImageTransparency = 0.85
            }):Play()
            
            for i = 1, #nt.Text do
                nt.MaxVisibleGraphemes = i
                task.wait(tas)
            end
            
            task.wait(0.1)
            
            local dl = #nd.Text
            local bs = math.ceil(dl / 50)
            local cc = 0
            
            while cc < dl do
                local nb = math.min(cc + bs, dl)
                nd.MaxVisibleGraphemes = nb
                cc = nb
                task.wait(tas * 2)
            end
            
            task.wait(0.2)
            
            ob.BackgroundTransparency = 1
            bt.TextTransparency = 1
            bi.ImageTransparency = 1
            obs.Transparency = 1
            
            tweensv:Create(ob, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {
                BackgroundTransparency = 0
            }):Play()
            
            tweensv:Create(bt, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {
                TextTransparency = 0
            }):Play()
            
            tweensv:Create(bi, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {
                ImageTransparency = 0
            }):Play()
            
            tweensv:Create(obs, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {
                Transparency = 0.2
            }):Play()
            
            task.spawn(function()
                while nf.Parent do
                    tweensv:Create(lg, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                        ImageTransparency = 0.75
                    }):Play()
                    
                    tweensv:Create(rg, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                        ImageTransparency = 0.75
                    }):Play()
                    
                    task.wait(1.5)
                    
                    tweensv:Create(lg, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                        ImageTransparency = 0.85
                    }):Play()
                    
                    tweensv:Create(rg, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                        ImageTransparency = 0.85
                    }):Play()
                    
                    task.wait(1.5)
                end
            end)
            
            if timer and type(timer) == "number" and timer > 0 then
                task.delay(timer, function()
                    if nf and nf.Parent then
                        cx()
                    end
                end)
            end
        end)

            function cx()
            for _, tw in pairs(tweensv:GetChildren()) do
                if tw.Instance and (tw.Instance:IsDescendantOf(nf) or tw.Instance == nf) then
                    tw:Cancel()
                end
            end
            
            local cd = 0.4
            
            tweensv:Create(nt, TweenInfo.new(cd * 0.7), {
                TextTransparency = 1
            }):Play()
            
            tweensv:Create(nd, TweenInfo.new(cd * 0.7), {
                TextTransparency = 1
            }):Play()
            
            tweensv:Create(ob, TweenInfo.new(cd * 0.5), {
                BackgroundTransparency = 1
            }):Play()
            
            tweensv:Create(bt, TweenInfo.new(cd * 0.5), {
                TextTransparency = 1
            }):Play()
            
            tweensv:Create(bi, TweenInfo.new(cd * 0.5), {
                ImageTransparency = 1
            }):Play()
            
            tweensv:Create(ni, TweenInfo.new(cd * 0.6), {
                ImageTransparency = 1
            }):Play()
            
            tweensv:Create(lg, TweenInfo.new(cd * 0.3), {
                ImageTransparency = 1
            }):Play()
            
            tweensv:Create(rg, TweenInfo.new(cd * 0.3), {
                ImageTransparency = 1
            }):Play()
            
            for _, pt in ipairs(pts) do
                tweensv:Create(pt, TweenInfo.new(cd * 0.5), {
                    BackgroundTransparency = 1
                }):Play()
            end
            
            for _, ac in pairs({la, ra}) do
                tweensv:Create(ac, TweenInfo.new(cd * 0.7), {
                    Size = UDim2.new(0, 3, 0, 0),
                    BackgroundTransparency = 1
                }):Play()
            end
            
            for _, ac in pairs({ta, ba}) do
                tweensv:Create(ac, TweenInfo.new(cd * 0.7), {
                    Size = UDim2.new(0, 0, 0, 1),
                    BackgroundTransparency = 1
                }):Play()
            end
            
            task.wait(cd * 0.5)
            
            tweensv:Create(nfs, TweenInfo.new(cd * 0.3), {
                Transparency = 1
            }):Play()
            
            local ct = tweensv:Create(nf, TweenInfo.new(cd, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
                Size = UDim2.new(0, 0, 0, 0)
            })
            
            ct:Play()
            ct.Completed:Wait()
            
            for i = 1, 10 do
                nb.BackgroundTransparency = 0.5 + (i * 0.05)
                task.wait(0.01)
            end
            
            nh:Destroy()
        end

        library.Conn[#library.Conn + 1] = ob.MouseEnter:Connect(function()
            tweensv:Create(ob, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
                BackgroundColor3 = Color3.fromRGB(55, 55, 55)
            }):Play()
            
            tweensv:Create(obs, TweenInfo.new(0.2), {
                Transparency = 0
            }):Play()
            
            tweensv:Create(bi, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 20, 0, 20),
                Position = UDim2.new(0, 6, 0.5, -10)
            }):Play()
        end)

        library.Conn[#library.Conn + 1] = ob.MouseLeave:Connect(function()
            tweensv:Create(ob, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
                BackgroundColor3 = Color3.fromRGB(45, 45, 45)
            }):Play()
            
            tweensv:Create(obs, TweenInfo.new(0.2), {
                Transparency = 0.2
            }):Play()
            
            tweensv:Create(bi, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 16, 0, 16),
                Position = UDim2.new(0, 8, 0.5, -8)
            }):Play()
        end)
        
        library.Conn[#library.Conn + 1] = ob.MouseButton1Down:Connect(function()
            tweensv:Create(ob, TweenInfo.new(0.1, Enum.EasingStyle.Quad), {
                BackgroundColor3 = Color3.fromRGB(40, 40, 40),
                Size = UDim2.new(0, 126, 0, 34)
            }):Play()
            
            tweensv:Create(bi, TweenInfo.new(0.1, Enum.EasingStyle.Quad), {
                Position = UDim2.new(0, 5, 0.5, -10)
            }):Play()
        end)
        
        library.Conn[#library.Conn + 1] = ob.MouseButton1Up:Connect(function()
            tweensv:Create(ob, TweenInfo.new(0.1, Enum.EasingStyle.Quad), {
                BackgroundColor3 = Color3.fromRGB(55, 55, 55),
                Size = UDim2.new(0, 130, 0, 36)
            }):Play()
            
            tweensv:Create(bi, TweenInfo.new(0.1, Enum.EasingStyle.Quad), {
                Position = UDim2.new(0, 6, 0.5, -10)
            }):Play()
        end)

        library.Conn[#library.Conn + 1] = cb.MouseEnter:Connect(function()
            tweensv:Create(cb, TweenInfo.new(0.2), {
                ImageColor3 = Color3.fromRGB(255, 255, 255)
            }):Play()
        end)

        library.Conn[#library.Conn + 1] = cb.MouseLeave:Connect(function()
            tweensv:Create(cb, TweenInfo.new(0.2), {
                ImageColor3 = Color3.fromRGB(180, 180, 180)
            }):Play()
        end)

        library.Conn[#library.Conn + 1] = cb.MouseButton1Click:Connect(cx)
        library.Conn[#library.Conn + 1] = ob.MouseButton1Click:Connect(cx)
    end

    local tabhold = {}
    function tabhold:Tab(text)
        local TabBtn = Instance.new("TextButton")
        local TabTitle = Instance.new("TextLabel")
        local TabBtnIndicator = Instance.new("Frame")
        local TabBtnIndicatorCorner = Instance.new("UICorner")

        TabBtn.Name = "TabBtn"
        TabBtn.Parent = TabHold
        TabBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        TabBtn.BackgroundTransparency = 1.000
        TabBtn.Size = UDim2.new(0, 107, 0, 21)
        TabBtn.Font = Enum.Font.SourceSans
        TabBtn.Text = ""
        TabBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
        TabBtn.TextSize = 14.000

        TabTitle.Name = "TabTitle"
        TabTitle.Parent = TabBtn
        TabTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        TabTitle.BackgroundTransparency = 1.000
        TabTitle.Size = UDim2.new(0, 107, 0, 21)
        TabTitle.Font = Enum.Font.Gotham
        TabTitle.Text = text
        TabTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
        TabTitle.TextSize = 14.000
        TabTitle.TextXAlignment = Enum.TextXAlignment.Left

        TabBtnIndicator.Name = "TabBtnIndicator"
        TabBtnIndicator.Parent = TabBtn
        TabBtnIndicator.BackgroundColor3 = PresetColor
        TabBtnIndicator.BorderSizePixel = 0
        TabBtnIndicator.Position = UDim2.new(0, 0, 1, 0)
        TabBtnIndicator.Size = UDim2.new(0, 0, 0, 5)

        TabBtnIndicatorCorner.Name = "TabBtnIndicatorCorner"
        TabBtnIndicatorCorner.Parent = TabBtnIndicator

        coroutine.wrap(function()
            while getgenv().libloaded do
                TabBtnIndicator.BackgroundColor3 = PresetColor
				task.wait()
            end
        end)()

        local Tab = Instance.new("ScrollingFrame")
        local TabLayout = Instance.new("UIListLayout")

        Tab.Name = "Tab"
        Tab.Parent = TabFolder
        Tab.Active = true
        Tab.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        Tab.BackgroundTransparency = 1.000
        Tab.BorderSizePixel = 0
        Tab.Position = UDim2.new(0.31400001, 0, 0.147, 0)
        Tab.Size = UDim2.new(0, 373, 0, 254)
        Tab.CanvasSize = UDim2.new(0, 0, 0, 0)
        Tab.ScrollBarThickness = 3
        Tab.Visible = false

        TabLayout.Name = "TabLayout"
        TabLayout.Parent = Tab
        TabLayout.SortOrder = Enum.SortOrder.LayoutOrder
        TabLayout.Padding = UDim.new(0, 6)

        if fs == false then
            fs = true
            TabBtnIndicator.Size = UDim2.new(0, 13, 0, 2)
            TabTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
            Tab.Visible = true
        end

        library.Conn[#library.Conn + 1] = TabBtn.MouseButton1Click:Connect(function()
            for i, v in next, TabFolder:GetChildren() do
                if v.Name == "Tab" then
                    v.Visible = false
                end
                Tab.Visible = true
            end
            for i, v in next, TabHold:GetChildren() do
                if v.Name == "TabBtn" then
                    v.TabBtnIndicator.Size = UDim2.new(0, 0, 0, 2)
                    TabBtnIndicator.Size = UDim2.new(0, 13, 0, 2)
                end
            end
        end)
        local tabcontent = {}
        function tabcontent:Button(text, callback)
            local Button = Instance.new("TextButton")
            local ButtonCorner = Instance.new("UICorner")
            local ButtonTitle = Instance.new("TextLabel")
            Button.Name = "Button"
            Button.Parent = Tab
            Button.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
            Button.Size = UDim2.new(0, 363, 0, 42)
            Button.AutoButtonColor = false
            Button.Font = Enum.Font.SourceSans
            Button.Text = ""
            Button.TextColor3 = Color3.fromRGB(0, 0, 0)
            Button.TextSize = 14.000
            ButtonCorner.CornerRadius = UDim.new(0, 5)
            ButtonCorner.Name = "ButtonCorner"
            ButtonCorner.Parent = Button
            ButtonTitle.Name = "ButtonTitle"
            ButtonTitle.Parent = Button
            ButtonTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            ButtonTitle.BackgroundTransparency = 1.000
            ButtonTitle.Position = UDim2.new(0.0358126722, 0, 0, 0)
            ButtonTitle.Size = UDim2.new(0, 187, 0, 42)
            ButtonTitle.Font = Enum.Font.SourceSans
            ButtonTitle.Text = text
            ButtonTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
            ButtonTitle.TextSize = 18
            ButtonTitle.TextXAlignment = Enum.TextXAlignment.Left
            library.Conn[#library.Conn + 1] = Button.MouseButton1Click:Connect(function()
                local suc, res = pcall(callback)
                if library.debug then
                    warn("Callback Error: ", res)
                end
            end)

            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
        end

        function tabcontent:Toggle(text, default, callback, flag)
            local flag = flag or text
            local toggled = default or false
            
            local Toggle = Instance.new("TextButton")
            local ToggleCorner = Instance.new("UICorner")
            local ToggleTitle = Instance.new("TextLabel")
            local FrameToggle1 = Instance.new("Frame")
            local FrameToggle1Corner = Instance.new("UICorner")
            local FrameToggle2 = Instance.new("Frame")
            local FrameToggle2Corner = Instance.new("UICorner")
            local FrameToggle3 = Instance.new("Frame")
            local FrameToggle3Corner = Instance.new("UICorner")
            local FrameToggleCircle = Instance.new("Frame")
            local FrameToggleCircleCorner = Instance.new("UICorner")
            
            Toggle.Name = "Toggle"
            Toggle.Parent = Tab
            Toggle.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
            Toggle.Position = UDim2.new(0.215625003, 0, 0.446271926, 0)
            Toggle.Size = UDim2.new(0, 363, 0, 42)
            Toggle.AutoButtonColor = false
            Toggle.Font = Enum.Font.SourceSans
            Toggle.Text = ""
            Toggle.TextColor3 = Color3.fromRGB(0, 0, 0)
            Toggle.TextSize = 14

            ToggleCorner.CornerRadius = UDim.new(0, 5)
            ToggleCorner.Name = "ToggleCorner"
            ToggleCorner.Parent = Toggle

            ToggleTitle.Name = "ToggleTitle"
            ToggleTitle.Parent = Toggle
            ToggleTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            ToggleTitle.BackgroundTransparency = 1.000
            ToggleTitle.Position = UDim2.new(0.05, 0, 0, 0)
            ToggleTitle.Size = UDim2.new(0.95, 0, 0, 40)
            ToggleTitle.Font = Enum.Font.SourceSans
            ToggleTitle.Text = text
            ToggleTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
            ToggleTitle.TextSize = 18
            ToggleTitle.TextXAlignment = Enum.TextXAlignment.Left

            FrameToggle1.Name = "FrameToggle1"
            FrameToggle1.Parent = Toggle
            FrameToggle1.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            FrameToggle1.Position = UDim2.new(0.859504104, 0, 0.285714298, 0)
            FrameToggle1.Size = UDim2.new(0, 37, 0, 18)

            FrameToggle1Corner.Name = "FrameToggle1Corner"
            FrameToggle1Corner.Parent = FrameToggle1

            FrameToggle2.Name = "FrameToggle2"
            FrameToggle2.Parent = FrameToggle1
            FrameToggle2.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
            FrameToggle2.Position = UDim2.new(0.0489999987, 0, 0.0930000022, 0)
            FrameToggle2.Size = UDim2.new(0, 33, 0, 14)

            FrameToggle2Corner.Name = "FrameToggle2Corner"
            FrameToggle2Corner.Parent = FrameToggle2

            FrameToggle3.Name = "FrameToggle3"
            FrameToggle3.Parent = FrameToggle1
            FrameToggle3.BackgroundColor3 = PresetColor
            FrameToggle3.BackgroundTransparency = 1.000
            FrameToggle3.Size = UDim2.new(0, 37, 0, 18)

            FrameToggle3Corner.Name = "FrameToggle3Corner"
            FrameToggle3Corner.Parent = FrameToggle3

            FrameToggleCircle.Name = "FrameToggleCircle"
            FrameToggleCircle.Parent = FrameToggle1
            FrameToggleCircle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            FrameToggleCircle.Position = UDim2.new(0.127000004, 0, 0.222000003, 0)
            FrameToggleCircle.Size = UDim2.new(0, 10, 0, 10)

            FrameToggleCircleCorner.Name = "FrameToggleCircleCorner"
            FrameToggleCircleCorner.Parent = FrameToggleCircle
            
            coroutine.wrap(function()
                while getgenv().libloaded do
                    FrameToggle3.BackgroundColor3 = PresetColor
                    task.wait()
                end
            end)()
            
            local function ToggleState(state)
                if state then
                    tweensv:Create(Toggle, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundColor3 = Color3.fromRGB(37, 37, 37)}):Play()
                    tweensv:Create(FrameToggle1, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 1}):Play()
                    tweensv:Create(FrameToggle2, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 1}):Play()
                    tweensv:Create(FrameToggle3, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
                    tweensv:Create(FrameToggleCircle, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundColor3 = Color3.fromRGB(255, 255, 255)}):Play()
                    FrameToggleCircle.Position = UDim2.new(0.587, 0, 0.222000003, 0)
                else
                    tweensv:Create(Toggle, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundColor3 = Color3.fromRGB(34, 34, 34)}):Play()
                    tweensv:Create(FrameToggle1, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
                    tweensv:Create(FrameToggle2, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
                    tweensv:Create(FrameToggle3, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 1}):Play()
                    tweensv:Create(FrameToggleCircle, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundColor3 = Color3.fromRGB(50, 50, 50)}):Play()
                    FrameToggleCircle.Position = UDim2.new(0.127000004, 0, 0.222000003, 0)
                end
                toggled = state
                
                if callback then
                    task.spawn(function()
                        local success, err = pcall(callback, toggled)
                        if not success and library.debug then
                            warn("Toggle Callback Error:", err)
                        end
                    end)
                end
            end
            
            local toggle = {
                value = toggled,
                set = function(self, state)
                    if type(state) == "boolean" then
                        ToggleState(state)
                        self.value = state
                    end
                    return self
                end,
                toggle = function(self)
                    self:set(not toggled)
                    return self
                end,
                enable = function(self)
                    if not toggled then
                        self:set(true)
                    end
                    return self
                end,
                disable = function(self)
                    if toggled then
                        self:set(false)
                    end
                    return self
                end,
                getState = function(self)
                    return toggled
                end,
                onStateChanged = function(self, newCallback)
                    callback = newCallback
                    return self
                end
            }

            if not library.flags then library.flags = {} end
            library.flags[flag] = toggle

            library.Conn[#library.Conn + 1] = Toggle.MouseButton1Click:Connect(function()
                toggle:set(not toggled)
            end)
            
            library.Conn[#library.Conn + 1] = Toggle.MouseEnter:Connect(function()
                tweensv:Create(Toggle, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(38, 38, 38)}):Play()
            end)
            
            library.Conn[#library.Conn + 1] = Toggle.MouseLeave:Connect(function()
                tweensv:Create(Toggle, TweenInfo.new(0.2), {BackgroundColor3 = toggled and Color3.fromRGB(37, 37, 37) or Color3.fromRGB(34, 34, 34)}):Play()
            end)
            
            if default then
                ToggleState(true)
            end
            
            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
            return toggle
        end

        function tabcontent:KeybindT(text, default, keybind, callback, flag)
            flag = flag or text
            local toggled = default or false
            local assignedKey = keybind or Enum.KeyCode.Unknown
            local SelectingKey = false
            local MenuOpen = false
            local keybindMode = "Toggle"
            local keyState = false
            local isChangingMode = false

            local Toggle = Instance.new("TextButton")
            local ToggleCorner = Instance.new("UICorner")
            local ToggleTitle = Instance.new("TextLabel")
            local FrameToggle1 = Instance.new("Frame")
            local FrameToggle1Corner = Instance.new("UICorner")
            local FrameToggle2 = Instance.new("Frame")
            local FrameToggle2Corner = Instance.new("UICorner")
            local FrameToggle3 = Instance.new("Frame")
            local FrameToggle3Corner = Instance.new("UICorner")
            local FrameToggleCircle = Instance.new("Frame")
            local FrameToggleCircleCorner = Instance.new("UICorner")
            local KeybindDisplay = Instance.new("TextButton")
            local KeybindDisplayCorner = Instance.new("UICorner")
            local KeybindDisplayStroke = Instance.new("UIStroke")

            Toggle.Name = "Toggle"
            Toggle.Parent = Tab
            Toggle.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
            Toggle.Position = UDim2.new(0.215625003, 0, 0.446271926, 0)
            Toggle.Size = UDim2.new(0, 363, 0, 42)
            Toggle.AutoButtonColor = false
            Toggle.Font = Enum.Font.SourceSans
            Toggle.Text = ""
            Toggle.TextColor3 = Color3.fromRGB(0, 0, 0)
            Toggle.TextSize = 14
            Toggle.ClipsDescendants = true

            ToggleCorner.CornerRadius = UDim.new(0, 5)
            ToggleCorner.Name = "ToggleCorner"
            ToggleCorner.Parent = Toggle

            local FixedElements = Instance.new("Frame")
            FixedElements.Name = "FixedElements"
            FixedElements.Parent = Toggle
            FixedElements.BackgroundTransparency = 1
            FixedElements.Size = UDim2.new(1, 0, 0, 42)
            FixedElements.ZIndex = 5
            FixedElements.ClipsDescendants = false

            ToggleTitle.Name = "ToggleTitle"
            ToggleTitle.Parent = FixedElements
            ToggleTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            ToggleTitle.BackgroundTransparency = 1
            ToggleTitle.Position = UDim2.new(0.05, 0, 0, 0)
            ToggleTitle.Size = UDim2.new(0.5, 0, 1, 0)
            ToggleTitle.Font = Enum.Font.SourceSans
            ToggleTitle.Text = text
            ToggleTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
            ToggleTitle.TextSize = 18
            ToggleTitle.TextXAlignment = Enum.TextXAlignment.Left
            ToggleTitle.ZIndex = 5

            FrameToggle1.Name = "FrameToggle1"
            FrameToggle1.Parent = FixedElements
            FrameToggle1.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            FrameToggle1.Position = UDim2.new(0.85, 0, 0.5, -9)
            FrameToggle1.Size = UDim2.new(0, 37, 0, 18)
            FrameToggle1.ZIndex = 5

            FrameToggle1Corner.Name = "FrameToggle1Corner"
            FrameToggle1Corner.Parent = FrameToggle1

            FrameToggle2.Name = "FrameToggle2"
            FrameToggle2.Parent = FrameToggle1
            FrameToggle2.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
            FrameToggle2.Position = UDim2.new(0.05, 0, 0.1, 0)
            FrameToggle2.Size = UDim2.new(0, 33, 0, 14)
            FrameToggle2.ZIndex = 5

            FrameToggle2Corner.Name = "FrameToggle2Corner"
            FrameToggle2Corner.Parent = FrameToggle2

            FrameToggle3.Name = "FrameToggle3"
            FrameToggle3.Parent = FrameToggle1
            FrameToggle3.BackgroundColor3 = PresetColor
            FrameToggle3.BackgroundTransparency = 1
            FrameToggle3.Size = UDim2.new(0, 37, 0, 18)
            FrameToggle3.ZIndex = 5

            FrameToggle3Corner.Name = "FrameToggle3Corner"
            FrameToggle3Corner.Parent = FrameToggle3

            FrameToggleCircle.Name = "FrameToggleCircle"
            FrameToggleCircle.Parent = FrameToggle1
            FrameToggleCircle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            FrameToggleCircle.Position = UDim2.new(0.127, 0, 0.222, 0)
            FrameToggleCircle.Size = UDim2.new(0, 10, 0, 10)
            FrameToggleCircle.ZIndex = 5

            FrameToggleCircleCorner.Name = "FrameToggleCircleCorner"
            FrameToggleCircleCorner.Parent = FrameToggleCircle

            KeybindDisplay.Name = "KeybindDisplay"
            KeybindDisplay.Parent = FixedElements
            KeybindDisplay.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
            KeybindDisplay.BackgroundTransparency = 0.7
            KeybindDisplay.Position = UDim2.new(0.58, 0, 0.5, -10)
            KeybindDisplay.Size = UDim2.new(0.22, 0, 0, 20)
            KeybindDisplay.Font = Enum.Font.SourceSans
            KeybindDisplay.Text = "[" .. (assignedKey.Name == "Unknown" and "None" or assignedKey.Name) .. "]"
            KeybindDisplay.TextColor3 = Color3.fromRGB(255, 255, 255)
            KeybindDisplay.TextSize = 16
            KeybindDisplay.ZIndex = 5
            KeybindDisplay.AutoButtonColor = false

            KeybindDisplayCorner.CornerRadius = UDim.new(0, 4)
            KeybindDisplayCorner.Parent = KeybindDisplay

            KeybindDisplayStroke.Parent = KeybindDisplay
            KeybindDisplayStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
            KeybindDisplayStroke.Color = PresetColor
            KeybindDisplayStroke.Transparency = 0.6
            KeybindDisplayStroke.Thickness = 1

            local DropdownContent = Instance.new("Frame")
            DropdownContent.Name = "DropdownContent"
            DropdownContent.Parent = Toggle
            DropdownContent.BackgroundColor3 = Color3.fromRGB(37, 37, 37)
            DropdownContent.BorderSizePixel = 0
            DropdownContent.Position = UDim2.new(0, 0, 0, 42)
            DropdownContent.Size = UDim2.new(1, 0, 0, 88)
            DropdownContent.Visible = false
            DropdownContent.ZIndex = 2

            local DropdownContentCorner = Instance.new("UICorner")
            DropdownContentCorner.CornerRadius = UDim.new(0, 5)
            DropdownContentCorner.Parent = DropdownContent

            local DropdownContentLayout = Instance.new("UIListLayout")
            DropdownContentLayout.Parent = DropdownContent
            DropdownContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
            DropdownContentLayout.Padding = UDim.new(0, 5)
            DropdownContentLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

            local Separator = Instance.new("Frame")
            Separator.Name = "Separator"
            Separator.Parent = DropdownContent
            Separator.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            Separator.BorderSizePixel = 0
            Separator.Size = UDim2.new(1, -20, 0, 1)
            Separator.Position = UDim2.new(0, 10, 0, 5)
            Separator.ZIndex = 2
            Separator.LayoutOrder = 0

            local KeybindSection = Instance.new("Frame")
            KeybindSection.Name = "KeybindSection"
            KeybindSection.Parent = DropdownContent
            KeybindSection.BackgroundTransparency = 1
            KeybindSection.Size = UDim2.new(0.95, 0, 0, 35)
            KeybindSection.ZIndex = 2
            KeybindSection.LayoutOrder = 1

            local KeybindLabel = Instance.new("TextLabel")
            KeybindLabel.Name = "KeybindLabel"
            KeybindLabel.Parent = KeybindSection
            KeybindLabel.BackgroundTransparency = 1
            KeybindLabel.Position = UDim2.new(0.05, 0, 0, 0)
            KeybindLabel.Size = UDim2.new(0.35, 0, 1, 0)
            KeybindLabel.Font = Enum.Font.Gotham
            KeybindLabel.Text = "Keybind"
            KeybindLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            KeybindLabel.TextSize = 14
            KeybindLabel.TextXAlignment = Enum.TextXAlignment.Left
            KeybindLabel.ZIndex = 2

            local KeybindButton = Instance.new("TextButton")
            KeybindButton.Name = "KeybindButton"
            KeybindButton.Parent = KeybindSection
            KeybindButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
            KeybindButton.Position = UDim2.new(0.5, 0, 0, 0)
            KeybindButton.Size = UDim2.new(0.45, 0, 1, 0)
            KeybindButton.Font = Enum.Font.Gotham
            KeybindButton.Text = assignedKey.Name == "Unknown" and "None" or assignedKey.Name
            KeybindButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            KeybindButton.TextSize = 13
            KeybindButton.ZIndex = 2
            KeybindButton.AutoButtonColor = false

            local KeybindButtonCorner = Instance.new("UICorner")
            KeybindButtonCorner.CornerRadius = UDim.new(0, 4)
            KeybindButtonCorner.Parent = KeybindButton

            local KeybindButtonStroke = Instance.new("UIStroke")
            KeybindButtonStroke.Parent = KeybindButton
            KeybindButtonStroke.Color = PresetColor
            KeybindButtonStroke.Thickness = 1
            KeybindButtonStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

            local ModeSection = Instance.new("Frame")
            ModeSection.Name = "ModeSection"
            ModeSection.Parent = DropdownContent
            ModeSection.BackgroundTransparency = 1
            ModeSection.Size = UDim2.new(0.95, 0, 0, 35)
            ModeSection.ZIndex = 2
            ModeSection.LayoutOrder = 2

            local ModeLabel = Instance.new("TextLabel")
            ModeLabel.Name = "ModeLabel"
            ModeLabel.Parent = ModeSection
            ModeLabel.BackgroundTransparency = 1
            ModeLabel.Position = UDim2.new(0.05, 0, 0, 0)
            ModeLabel.Size = UDim2.new(0.35, 0, 1, 0)
            ModeLabel.Font = Enum.Font.Gotham
            ModeLabel.Text = "Mode"
            ModeLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            ModeLabel.TextSize = 14
            ModeLabel.TextXAlignment = Enum.TextXAlignment.Left
            ModeLabel.ZIndex = 2

            local ModeHolder = Instance.new("Frame")
            ModeHolder.Name = "ModeHolder"
            ModeHolder.Parent = ModeSection
            ModeHolder.BackgroundTransparency = 1
            ModeHolder.Position = UDim2.new(0.5, 0, 0, 0)
            ModeHolder.Size = UDim2.new(0.45, 0, 1, 0)
            ModeHolder.ZIndex = 2

            local ModeLayout = Instance.new("UIListLayout")
            ModeLayout.Parent = ModeHolder
            ModeLayout.FillDirection = Enum.FillDirection.Horizontal
            ModeLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
            ModeLayout.SortOrder = Enum.SortOrder.LayoutOrder
            ModeLayout.Padding = UDim.new(0, 5)

            local modeButtons = {}

            local function createModeButton(name, order)
                local ModeButton = Instance.new("TextButton")
                ModeButton.Name = name .. "Button"
                ModeButton.Parent = ModeHolder
                ModeButton.BackgroundColor3 = keybindMode == name and PresetColor or Color3.fromRGB(45, 45, 45)
                ModeButton.BackgroundTransparency = keybindMode == name and 0 or 0.4
                ModeButton.Size = UDim2.new(0, 45, 1, 0)
                ModeButton.Font = Enum.Font.Gotham
                ModeButton.Text = name
                ModeButton.TextColor3 = keybindMode == name and Color3.fromRGB(35, 35, 35) or Color3.fromRGB(255, 255, 255)
                ModeButton.TextSize = 12
                ModeButton.LayoutOrder = order
                ModeButton.ZIndex = 2
                ModeButton.AutoButtonColor = false

                local ModeButtonCorner = Instance.new("UICorner")
                ModeButtonCorner.CornerRadius = UDim.new(0, 4)
                ModeButtonCorner.Parent = ModeButton

                modeButtons[name] = ModeButton

                return ModeButton
            end

            local ToggleButton = createModeButton("Toggle", 1)
            local HoldButton = createModeButton("Hold", 2)
            local AlwaysButton = createModeButton("Always", 3)

            coroutine.wrap(function()
                while getgenv().libloaded do
                    FrameToggle3.BackgroundColor3 = PresetColor
                    KeybindButtonStroke.Color = PresetColor
                    KeybindDisplayStroke.Color = PresetColor
                    for mode, button in pairs(modeButtons) do
                        if mode == keybindMode then
                            button.BackgroundColor3 = PresetColor
                        end
                    end
                    task.wait()
                end
            end)()

            local function ToggleState(state)
                toggled = state
                if toggled then
                    if FrameToggleCircle and FrameToggleCircle.TweenPosition then
                        FrameToggleCircle:TweenPosition(UDim2.new(0.587, 0, 0.222, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
                    end
                    if FrameToggle3 then
                        FrameToggle3.BackgroundTransparency = 0
                    end
                    if keybindMode == "Always" then
                        keyState = true
                        pcall(callback, true)
                    end
                else
                    if FrameToggleCircle and FrameToggleCircle.TweenPosition then
                        FrameToggleCircle:TweenPosition(UDim2.new(0.127, 0, 0.222, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
                    end
                    if FrameToggle3 then
                        FrameToggle3.BackgroundTransparency = 1
                    end
                    if keybindMode == "Always" or keybindMode == "Hold" then
                        keyState = false
                        pcall(callback, false)
                    elseif keybindMode == "Toggle" and keyState then
                        keyState = false
                        pcall(callback, false)
                    end
                end
            end

            local keybindT = {
                value = toggled,
                keyCode = assignedKey,
                mode = keybindMode,
                keyState = keyState,
                set = function(self, state)
                    if type(state) == "boolean" then
                        ToggleState(state)
                        self.value = state
                        return self
                    end
                    
                    if type(state) == "table" then
                        if type(state.value) == "boolean" then
                            ToggleState(state.value)
                            self.value = state.value
                        end
                        
                        if typeof(state.keyCode) == "EnumItem" and state.keyCode.EnumType == Enum.KeyCode then
                            assignedKey = state.keyCode
                            self.keyCode = state.keyCode
                            KeybindDisplay.Text = "[" .. (state.keyCode.Name == "Unknown" and "None" or state.keyCode.Name) .. "]"
                            KeybindButton.Text = state.keyCode.Name == "Unknown" and "None" or state.keyCode.Name
                        elseif type(state.keyCode) == "string" then
                            local success, keyEnum = pcall(function()
                                return Enum.KeyCode[state.keyCode]
                            end)
                            if success and keyEnum then
                                assignedKey = keyEnum
                                self.keyCode = keyEnum
                                KeybindDisplay.Text = "[" .. (keyEnum.Name == "Unknown" and "None" or keyEnum.Name) .. "]"
                                KeybindButton.Text = keyEnum.Name == "Unknown" and "None" or keyEnum.Name
                            end
                        end
                        
                        if type(state.mode) == "string" and (state.mode == "Toggle" or state.mode == "Hold" or state.mode == "Always") then
                            self:setMode(state.mode)
                        end
                        
                        if type(state.keyState) == "boolean" then
                            self:setKeyState(state.keyState)
                        end
                        
                        return self
                    end
                    
                    if typeof(state) == "EnumItem" and state.EnumType == Enum.KeyCode then
                        assignedKey = state
                        self.keyCode = state
                        KeybindDisplay.Text = "[" .. (state.Name == "Unknown" and "None" or state.Name) .. "]"
                        KeybindButton.Text = state.Name == "Unknown" and "None" or state.Name
                        return self
                    end
                    
                    return self
                end,
                setKey = function(self, key)
                    if typeof(key) == "EnumItem" and key.EnumType == Enum.KeyCode then
                        assignedKey = key
                        self.keyCode = key
                        KeybindDisplay.Text = "[" .. (key.Name == "Unknown" and "None" or key.Name) .. "]"
                        KeybindButton.Text = key.Name == "Unknown" and "None" or key.Name
                    elseif type(key) == "string" then
                        local success, keyEnum = pcall(function()
                            return Enum.KeyCode[key]
                        end)
                        if success and keyEnum then
                            assignedKey = keyEnum
                            self.keyCode = keyEnum
                            KeybindDisplay.Text = "[" .. (keyEnum.Name == "Unknown" and "None" or keyEnum.Name) .. "]"
                            KeybindButton.Text = keyEnum.Name == "Unknown" and "None" or keyEnum.Name
                        end
                    end
                    return self
                end,
                setMode = function(self, mode)
                    if type(mode) == "string" and (mode == "Toggle" or mode == "Hold" or mode == "Always") then
                        if mode == keybindMode then
                            return self
                        end
                        
                        local oldMode = keybindMode
                        keybindMode = mode
                        self.mode = mode
                        
                        for modeName, button in pairs(modeButtons) do
                            if modeName == keybindMode then
                                button.BackgroundColor3 = PresetColor
                                button.BackgroundTransparency = 0
                                button.TextColor3 = Color3.fromRGB(35, 35, 35)
                            else
                                button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
                                button.BackgroundTransparency = 0.4
                                button.TextColor3 = Color3.fromRGB(255, 255, 255)
                            end
                        end
                        
                        if keybindMode == "Always" and toggled then
                            keyState = true
                            self.keyState = true
                            pcall(callback, true)
                        elseif oldMode == "Always" and toggled then
                            keyState = false
                            self.keyState = false
                            pcall(callback, false)
                        end
                    end
                    return self
                end,
                setKeyState = function(self, state)
                    if type(state) == "boolean" then
                        if keybindMode == "Always" and not toggled then
                            keyState = false
                            self.keyState = false
                            return self
                        end
                        
                        keyState = state
                        self.keyState = state
                        pcall(callback, keyState)
                    end
                    return self
                end,
                toggleKeyState = function(self)
                    if keybindMode == "Always" then
                        return self
                    end
                    return self:setKeyState(not keyState)
                end,
                getKeyState = function(self)
                    return keyState
                end,
                toggle = function(self)
                    self:set(not toggled)
                    return self
                end,
                enable = function(self)
                    if not toggled then
                        self:set(true)
                    end
                    return self
                end,
                disable = function(self)
                    if toggled then
                        self:set(false)
                    end
                    return self
                end,
                getState = function(self)
                    return toggled
                end
            }

            if not library.flags then library.flags = {} end
            library.flags[flag] = keybindT

            local function ToggleMenu()
                MenuOpen = not MenuOpen
                DropdownContent.Visible = MenuOpen
                if MenuOpen then
                    if tweensv and Toggle then
                        tweensv:Create(Toggle, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out),
                            {Size = UDim2.new(0, 363, 0, 140)}):Play()
                    end
                    task.delay(0.05, function()
                        if Tab and TabLayout then
                            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y + 98)
                        end
                    end)
                else
                    if tweensv and Toggle then
                        tweensv:Create(Toggle, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.In),
                            {Size = UDim2.new(0, 363, 0, 42)}):Play()
                    end
                    task.delay(0.25, function()
                        if Tab and TabLayout then
                            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                        end
                    end)
                end
            end

            local isHolding = false
            local keybindConnections = {}

            table.insert(keybindConnections, Toggle.MouseButton1Click:Connect(function()
                if not SelectingKey then ToggleState(not toggled) end
            end))
            table.insert(keybindConnections, Toggle.MouseButton2Click:Connect(ToggleMenu))

            table.insert(keybindConnections, KeybindDisplay.MouseButton1Click:Connect(ToggleMenu))
            table.insert(keybindConnections, KeybindDisplay.MouseEnter:Connect(function()
                if tweensv then
                    tweensv:Create(KeybindDisplay, TweenInfo.new(0.2), {BackgroundTransparency = 0.5}):Play()
                    tweensv:Create(KeybindDisplayStroke, TweenInfo.new(0.2), {Transparency = 0.3}):Play()
                end
            end))
            table.insert(keybindConnections, KeybindDisplay.MouseLeave:Connect(function()
                if tweensv then
                    tweensv:Create(KeybindDisplay, TweenInfo.new(0.2), {BackgroundTransparency = 0.7}):Play()
                    tweensv:Create(KeybindDisplayStroke, TweenInfo.new(0.2), {Transparency = 0.6}):Play()
                end
            end))

            table.insert(keybindConnections, KeybindButton.MouseButton1Click:Connect(function()
                if SelectingKey then return end
                SelectingKey = true
                KeybindButton.Text = "..."
                local connection
                connection = uis.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.Keyboard then
                        assignedKey = input.KeyCode
                        keybindT.keyCode = assignedKey
                        KeybindDisplay.Text = "[" .. assignedKey.Name .. "]"
                        KeybindButton.Text = assignedKey.Name == "Unknown" and "None" or assignedKey.Name
                        SelectingKey = false
                        if connection then connection:Disconnect() end
                    end
                end)
                task.delay(5, function()
                    if SelectingKey then
                        SelectingKey = false
                        if connection then connection:Disconnect() end
                        KeybindButton.Text = assignedKey.Name == "Unknown" and "None" or assignedKey.Name
                    end
                end)
            end))

            table.insert(keybindConnections, ToggleButton.MouseButton1Click:Connect(function()
                if isChangingMode then return end
                isChangingMode = true
                keybindT:setMode("Toggle")
                task.delay(0.3, function() isChangingMode = false end)
            end))
            table.insert(keybindConnections, HoldButton.MouseButton1Click:Connect(function()
                if isChangingMode then return end
                isChangingMode = true
                keybindT:setMode("Hold")
                task.delay(0.3, function() isChangingMode = false end)
            end))
            table.insert(keybindConnections, AlwaysButton.MouseButton1Click:Connect(function()
                if isChangingMode then return end
                isChangingMode = true
                keybindT:setMode("Always")
                task.delay(0.3, function() isChangingMode = false end)
            end))

            for _, button in pairs(modeButtons) do
                table.insert(keybindConnections, button.MouseEnter:Connect(function()
                    if button.Text ~= keybindMode and tweensv then
                        tweensv:Create(button, TweenInfo.new(0.2), {BackgroundTransparency = 0.2}):Play()
                    end
                end))
                table.insert(keybindConnections, button.MouseLeave:Connect(function()
                    if button.Text ~= keybindMode and tweensv then
                        tweensv:Create(button, TweenInfo.new(0.2), {BackgroundTransparency = 0.4}):Play()
                    end
                end))
            end

            table.insert(keybindConnections, KeybindButton.MouseEnter:Connect(function()
                if tweensv then
                    tweensv:Create(KeybindButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(55, 55, 55)}):Play()
                end
            end))
            table.insert(keybindConnections, KeybindButton.MouseLeave:Connect(function()
                if tweensv then
                    tweensv:Create(KeybindButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(45, 45, 45)}):Play()
                end
            end))

            local function handleKeyInput(input, gameProcessed)
                if gameProcessed or input.UserInputType ~= Enum.UserInputType.Keyboard or SelectingKey then return end
                if assignedKey == nil or input.KeyCode ~= assignedKey then return end
                if not toggled then return end
                if keybindMode == "Toggle" then
                    keyState = not keyState
                    keybindT.keyState = keyState
                    pcall(callback, keyState)
                elseif keybindMode == "Hold" then
                    isHolding = true
                    keyState = true
                    keybindT.keyState = keyState
                    pcall(callback, keyState)
                end
            end

            local function handleKeyRelease(input, gameProcessed)
                if gameProcessed or input.UserInputType ~= Enum.UserInputType.Keyboard then return end
                if assignedKey == nil or input.KeyCode ~= assignedKey then return end
                if keybindMode == "Hold" and isHolding then
                    isHolding = false
                    if toggled then
                        keyState = false
                        keybindT.keyState = keyState
                        pcall(callback, keyState)
                    end
                end
            end

            table.insert(keybindConnections, uis.InputBegan:Connect(handleKeyInput))
            table.insert(keybindConnections, uis.InputEnded:Connect(handleKeyRelease))

            keybindT.destroy = function()
                for _, connection in ipairs(keybindConnections) do
                    pcall(function() connection:Disconnect() end)
                end
                pcall(function() Toggle:Destroy() end)
            end

            if default then ToggleState(true) end
            if Tab and TabLayout then
                Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
            end

            return keybindT
        end

            function tabcontent:NewSlider(text, low, high, precise, callback, default, flag)
                local ui = uis or SRV("UserInputService")
                local flag = flag or text
                local btn = Instance.new("TextButton")
                local lbl = Instance.new("TextLabel")
                local crn = Instance.new("UICorner")
                local bar = Instance.new("Frame")
                local hitbox = Instance.new("Frame")
                local bcrn = Instance.new("UICorner")
                local dot = Instance.new("Frame")
                local hid = Instance.new("Frame")
                local hcrn = Instance.new("UICorner")
                local dcrn = Instance.new("UICorner")
                local fill = Instance.new("Frame")
                local fcrn = Instance.new("UICorner")
                local stroke = Instance.new("UIStroke")
                local val = Instance.new("TextLabel")
                
                btn.Name = text
                btn.Parent = Tab
                btn.BackgroundColor3 = Color3.fromRGB(31, 31, 31)
                btn.BorderSizePixel = 0
                btn.Position = UDim2.new(0.286, 0, 0, 0)
                btn.Size = UDim2.new(0, 363, 0, 40)
                btn.AutoButtonColor = false
                btn.Font = Enum.Font.SourceSans
                btn.Text = ""
                btn.TextColor3 = Color3.fromRGB(0, 0, 0)
                btn.TextSize = 14

                lbl.Name = "Label"
                lbl.Parent = btn
                lbl.BackgroundTransparency = 1
                lbl.Position = UDim2.new(0.05, 0, 0, 0)
                lbl.Size = UDim2.new(0.95, 0, 1, 0)
                lbl.Font = Enum.Font.Gotham
                lbl.Text = text
                lbl.TextColor3 = Color3.fromRGB(255, 255, 255)
                lbl.TextSize = 16
                lbl.TextXAlignment = Enum.TextXAlignment.Left

                crn.CornerRadius = UDim.new(0, 5)
                crn.Parent = btn

                bar.Name = "Bar"
                bar.Parent = btn
                bar.BackgroundColor3 = Color3.fromRGB(43, 43, 43)
                bar.BorderSizePixel = 0
                bar.Position = UDim2.new(0.58, 0, 0.421, 0)
                bar.Size = UDim2.new(0, 140, 0, 5)

                hitbox.Name = "Hitbox"
                hitbox.Parent = btn
                hitbox.BackgroundTransparency = 1
                hitbox.Position = UDim2.new(0.55, 0, 0, 0)
                hitbox.Size = UDim2.new(0, 150, 0, 40)
                hitbox.ZIndex = 5

                bcrn.CornerRadius = UDim.new(0, 15)
                bcrn.Parent = bar

                fill.Name = "Fill"
                fill.Parent = bar
                fill.BackgroundColor3 = Color3.fromRGB(0, 123, 255)
                fill.BorderSizePixel = 0
                fill.Size = UDim2.new(0.5, 0, 1, 0)

                fcrn.CornerRadius = UDim.new(0, 15)
                fcrn.Parent = fill

                dot.Name = "Dot"
                dot.Parent = fill
                dot.AnchorPoint = Vector2.new(0, 0.5)
                dot.BackgroundColor3 = Color3.fromRGB(0, 123, 255)
                dot.BorderSizePixel = 0
                dot.Position = UDim2.new(1, 0, 0.5, 0)
                dot.Size = UDim2.new(0, 14, 0, 14)
                dot.ZIndex = 2

                stroke.Parent = dot
                stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
                stroke.Thickness = 2
                stroke.Color = Color3.fromRGB(43,43,43)

                val.Name = "Value"
                val.Parent = dot
                val.AnchorPoint = Vector2.new(0.5, 0)
                val.BackgroundTransparency = 1
                val.Position = UDim2.new(0.5, 0, -1.491, 0)
                val.Size = UDim2.new(0, 30, 0, 20)
                val.Font = Enum.Font.GothamSemibold
                val.Text = (precise and string.format("%.1f", default or low)) or math.floor(default or low)
                val.TextColor3 = Color3.fromRGB(255, 255, 255)
                val.TextSize = 14

                hid.Name = "Hide"
                hid.Parent = dot
                hid.AnchorPoint = Vector2.new(0.5, 0.5)
                hid.BackgroundColor3 = Color3.fromRGB(43, 43, 43)
                hid.BorderSizePixel = 0
                hid.Position = UDim2.new(0.5, 0, 0.5, 0)
                hid.Size = UDim2.new(1, 1, 1, 1)
                hid.ZIndex = 2

                hcrn.CornerRadius = UDim.new(0, 100)
                hcrn.Parent = hid

                dcrn.CornerRadius = UDim.new(0, 100)
                dcrn.Parent = dot

                local state = {
                    dragging = false,
                    real = default or low,
                    show = precise and string.format("%.1f", default or low) or math.floor(default or low),
                    fromConfig = false
                }

                local slider = {}

                local function update(value, inputX)
                    local pct

                    if value then
                        value = tonumber(value) or state.real
                        pct = math.clamp((value - low) / (high - low), 0, 1)
                    elseif inputX then
                        pct = math.clamp((inputX - bar.AbsolutePosition.X) / bar.AbsoluteSize.X, 0, 1)
                    end

                    if state.fromConfig then
                        fill.Size = UDim2.new(pct, 0, 1, 0)
                    else
                        fill:TweenSize(UDim2.new(pct, 0, 1, 0), "Out", "Sine", 0.2, true)
                    end

                    state.real = low + (high - low) * pct
                    state.show = precise and string.format("%.1f", state.real) or math.floor(state.real)
                    val.Text = tostring(state.show)
                    slider.value = precise and tonumber(state.show) or math.floor(state.real)

                    if callback and not state.fromConfig then
                        pcall(callback, precise and tonumber(state.show) or math.floor(state.real))
                    end
                end

                slider.value = precise and tonumber(state.show) or math.floor(state.real)
                slider.set = function(s, value)
                    if type(value) == "number" or type(value) == "string" then
                        local num = tonumber(value)
                        if num then
                            state.fromConfig = true
                            update(num)
                            state.fromConfig = false
                            s.value = precise and tonumber(string.format("%.1f", num)) or math.floor(num)
                            if callback then
                                pcall(callback, s.value)
                            end
                        end
                    end
                    return s
                end
                slider.setMin = function(s, newLow)
                    if type(newLow) == "number" then
                        low = newLow
                        s:set(s.value)
                    end
                    return s
                end
                slider.setMax = function(s, newHigh)
                    if type(newHigh) == "number" then
                        high = newHigh
                        s:set(s.value)
                    end
                    return s
                end
                slider.getValue = function(s)
                    return state.real
                end

                library.flags = library.flags or {}
                library.flags[flag] = slider
                
                update(default or low)

                local connections = {}

                local function move(inputPos)
                    if not state.dragging then return end
                    update(nil, inputPos.X)
                end

                local function stopDragging()
                    if not state.dragging then return end
                    state.dragging = false
                    for i = #connections, 1, -1 do
                        if connections[i] then
                            connections[i]:Disconnect()
                            table.remove(connections, i)
                        end
                    end
                end

                local function startDrag(input)
                    if state.dragging then return end
                    
                    local validInput = (input.UserInputType == Enum.UserInputType.MouseButton1) or 
                                    (input.UserInputType == Enum.UserInputType.Touch)
                    
                    if validInput then
                        state.dragging = true
                        move(input.Position)
                        
                        for i = #connections, 1, -1 do
                            if connections[i] then
                                connections[i]:Disconnect()
                                table.remove(connections, i)
                            end
                        end
                        
                        if input.UserInputType == Enum.UserInputType.Touch then
                            table.insert(connections, ui.TouchMoved:Connect(function(touch, gameProcessed)
                                if not gameProcessed and state.dragging then
                                    move(touch.Position)
                                end
                            end))
                            table.insert(connections, ui.TouchEnded:Connect(function(touch, gameProcessed)
                                stopDragging()
                            end))
                        else
                            table.insert(connections, ui.InputChanged:Connect(function(changed)
                                if changed.UserInputType == Enum.UserInputType.MouseMovement and state.dragging then
                                    move(changed.Position)
                                end
                            end))
                            table.insert(connections, ui.InputEnded:Connect(function(inputEnd)
                                if inputEnd.UserInputType == Enum.UserInputType.MouseButton1 then
                                    stopDragging()
                                end
                            end))
                        end
                    end
                end

                library.Conn[#library.Conn + 1] = hitbox.InputBegan:Connect(startDrag)

                library.Conn[#library.Conn + 1] = btn.MouseEnter:Connect(function()
                    if not state.dragging then
                        hid:TweenSize(UDim2.new(0, 0, 0, 0), "Out", "Sine", 0.2, true)
                    end
                end)

                library.Conn[#library.Conn + 1] = btn.MouseLeave:Connect(function()
                    if not state.dragging then
                        hid:TweenSize(UDim2.new(1, 1, 1, 1), "In", "Sine", 0.2, true)
                    end
                end)

                Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                return slider
            end

            function tabcontent:NewDropdown(placeholder, Selectables, func, IsMulti, EnableSearch, flag)
                local flag = flag or placeholder
                local Dropdown = Instance.new("TextButton")
                local DropdownCorner = Instance.new("UICorner")
                local DropdownBox = Instance.new("TextButton")
                local ImageLabel = Instance.new("ImageLabel")
                local Tsd = Instance.new("Frame")
                local DropdownListCorner = Instance.new("UICorner")
                local DropdownListHeader = Instance.new("TextLabel")
                local DropdownListHeaderCorner = Instance.new("UICorner")
                local DropdownList = Instance.new("ScrollingFrame")
                local UIListLayout = Instance.new("UIListLayout")
                local DropdownLineTop = Instance.new("Frame")
                local DropdownLineBottom = Instance.new("Frame")
                local CloseButton = Instance.new("TextButton")
                local SearchBar = nil
                local SearchBarContainer = nil
                local SearchIcon = nil
                
                Dropdown.Name = "Dropdown"
                Dropdown.Parent = Tab
                Dropdown.BackgroundColor3 = Color3.fromRGB(31, 31, 31)
                Dropdown.BorderSizePixel = 0
                Dropdown.ClipsDescendants = true
                Dropdown.Position = UDim2.new(0.286780387, 0, 0, 0)
                Dropdown.Size = UDim2.new(0, 363, 0, 42)
                Dropdown.AutoButtonColor = false
                Dropdown.Font = Enum.Font.Gotham
                Dropdown.Text = ""
                Dropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
                Dropdown.TextSize = 14

                DropdownCorner.CornerRadius = UDim.new(0, 5)
                DropdownCorner.Name = "DropdownCorner"
                DropdownCorner.Parent = Dropdown

                DropdownBox.Name = "DropdownBox"
                DropdownBox.Parent = Dropdown
                DropdownBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                DropdownBox.BackgroundTransparency = 1.000
                DropdownBox.BorderSizePixel = 0
                DropdownBox.Position = UDim2.new(0.05, 0, 0, 0)
                DropdownBox.Size = UDim2.new(0.95, 0, 0, 40)
                DropdownBox.Font = Enum.Font.SourceSans
                DropdownBox.Text = placeholder
                DropdownBox.TextColor3 = Color3.fromRGB(255, 255, 255)
                DropdownBox.TextSize = 18
                DropdownBox.TextXAlignment = Enum.TextXAlignment.Left

                ImageLabel.Parent = DropdownBox
                ImageLabel.AnchorPoint = Vector2.new(0, 0.5)
                ImageLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                ImageLabel.BackgroundTransparency = 1.000
                ImageLabel.BorderSizePixel = 0
                ImageLabel.Position = UDim2.new(0.910000026, 0, 0.5, 0)
                ImageLabel.Size = UDim2.new(0, 40, 0, 35)
                ImageLabel.Image = "rbxassetid://3926305904"
                ImageLabel.ImageColor3 = Color3.fromRGB(136, 136, 136)
                ImageLabel.ImageRectOffset = Vector2.new(44, 404)
                ImageLabel.ImageRectSize = Vector2.new(36, 36)
                ImageLabel.Rotation = 90

                Tsd.Name = "DropdownPopup_" .. placeholder
                Tsd.Parent = Main
                Tsd.AnchorPoint = Vector2.new(0.5, 0.5)
                Tsd.BackgroundColor3 = Color3.fromRGB(27, 27, 27)
                Tsd.BorderSizePixel = 0
                Tsd.Position = UDim2.new(0.5, 0, 5, 0)
                Tsd.Size = UDim2.new(0, 360, 0, 270)
                Tsd.ZIndex = 10
                Tsd.Visible = true

                DropdownListCorner.CornerRadius = UDim.new(0, 5)
                DropdownListCorner.Name = "DropdownListCorner"
                DropdownListCorner.Parent = Tsd

                DropdownListHeader.Name = "DropdownListHeader"
                DropdownListHeader.Parent = Tsd
                DropdownListHeader.BackgroundColor3 = Color3.fromRGB(29, 29, 29)
                DropdownListHeader.BackgroundTransparency = 1
                DropdownListHeader.Position = UDim2.new(0, 15, 0, 0)
                DropdownListHeader.Size = UDim2.new(0, 280, 0, 39)
                DropdownListHeader.Font = Enum.Font.GothamSemibold
                DropdownListHeader.TextColor3 = Color3.fromRGB(255, 255, 255)
                DropdownListHeader.TextSize = 17.000
                DropdownListHeader.Text = placeholder
                DropdownListHeader.TextXAlignment = Enum.TextXAlignment.Left
                DropdownListHeader.ZIndex = 10

                DropdownListHeaderCorner.Name = "DropdownListHeaderCorner"
                DropdownListHeaderCorner.Parent = DropdownListHeader
                DropdownListHeaderCorner.CornerRadius = UDim.new(0, 5)

                CloseButton.Name = "CloseButton"
                CloseButton.Parent = Tsd
                CloseButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                CloseButton.BackgroundTransparency = 1.000
                CloseButton.BorderSizePixel = 0
                CloseButton.Position = UDim2.new(0.85, 0, 0, 0)
                CloseButton.Size = UDim2.new(0, 50, 0, 39)
                CloseButton.Font = Enum.Font.GothamSemibold
                CloseButton.Text = "Close"
                CloseButton.TextColor3 = Color3.fromRGB(0, 124, 255)
                CloseButton.TextSize = 15.000
                CloseButton.ZIndex = 11

                if EnableSearch == true then
                    SearchBarContainer = Instance.new("Frame")
                    SearchBarContainer.Name = "SearchBarContainer"
                    SearchBarContainer.Parent = Tsd
                    SearchBarContainer.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
                    SearchBarContainer.Position = UDim2.new(0, 15, 0, 40)
                    SearchBarContainer.Size = UDim2.new(0, 330, 0, 24)
                    SearchBarContainer.ZIndex = 12
                    
                    local SearchBarCorner = Instance.new("UICorner")
                    SearchBarCorner.CornerRadius = UDim.new(0, 4)
                    SearchBarCorner.Parent = SearchBarContainer
                    
                    SearchIcon = Instance.new("ImageLabel")
                    SearchIcon.Name = "SearchIcon"
                    SearchIcon.Parent = SearchBarContainer
                    SearchIcon.BackgroundTransparency = 1
                    SearchIcon.Position = UDim2.new(0, 8, 0, 4)
                    SearchIcon.Size = UDim2.new(0, 16, 0, 16)
                    SearchIcon.Image = "rbxassetid://3926305904"
                    SearchIcon.ImageRectOffset = Vector2.new(964, 324)
                    SearchIcon.ImageRectSize = Vector2.new(36, 36)
                    SearchIcon.ImageColor3 = Color3.fromRGB(180, 180, 180)
                    SearchIcon.ZIndex = 13
                    
                    SearchBar = Instance.new("TextBox")
                    SearchBar.Name = "SearchBar"
                    SearchBar.Parent = SearchBarContainer
                    SearchBar.BackgroundTransparency = 1
                    SearchBar.Position = UDim2.new(0, 30, 0, 0)
                    SearchBar.Size = UDim2.new(1, -40, 1, 0)
                    SearchBar.Font = Enum.Font.Gotham
                    SearchBar.Text = ""
                    SearchBar.PlaceholderText = "Search..."
                    SearchBar.TextColor3 = Color3.fromRGB(255, 255, 255)
                    SearchBar.TextSize = 12
                    SearchBar.TextXAlignment = Enum.TextXAlignment.Left
                    SearchBar.ZIndex = 13
                end

                DropdownList.Name = "DropdownList"
                DropdownList.Parent = Tsd
                DropdownList.Active = true
                DropdownList.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                DropdownList.BackgroundTransparency = 1
                DropdownList.BorderSizePixel = 0
                DropdownList.Position = UDim2.new(0, 0, 0, EnableSearch and 73 or 55)
                DropdownList.Size = UDim2.new(1, 0, 0, EnableSearch and 192 or 210)
                DropdownList.CanvasSize = UDim2.new(0, 0, 0, 0)
                DropdownList.ScrollBarThickness = 3
                DropdownList.AutomaticCanvasSize = Enum.AutomaticSize.Y
                DropdownList.ZIndex = 11

                UIListLayout.Parent = DropdownList
                UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
                UIListLayout.Padding = UDim.new(0, 0)
                UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

                DropdownLineTop.Parent = Tsd
                DropdownLineTop.AnchorPoint = Vector2.new(0.5, 0)
                DropdownLineTop.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
                DropdownLineTop.BorderSizePixel = 0
                DropdownLineTop.Position = UDim2.new(0.5, 0, 0, EnableSearch and 73 or 54)
                DropdownLineTop.Size = UDim2.new(1, 0, 0, 1)
                DropdownLineTop.ZIndex = 10

                DropdownLineBottom.Parent = Tsd
                DropdownLineBottom.AnchorPoint = Vector2.new(0.5, 0)
                DropdownLineBottom.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
                DropdownLineBottom.BorderSizePixel = 0
                DropdownLineBottom.Position = UDim2.new(0.5, 0, 0, 265)
                DropdownLineBottom.Size = UDim2.new(1, 0, 0, 1)
                DropdownLineBottom.ZIndex = 10

                local Stored = {}
                local SelectedValue = nil
                local SelectedItems = {}
                local AllSelectables = {}

                local dropdown = {
                    value = IsMulti and Stored or SelectedValue,
                    options = Selectables or {},
                }

                function NewSelectable(Text, val)
                    local SelectableButton = Instance.new("TextButton")
                    local SelectableText = Instance.new("TextLabel")
                    local SelectableCorner = Instance.new("UICorner")
                    local SecFrame = Instance.new("Frame")
                    local ChoosedCircle = Instance.new("Frame")
                    local InnerCircle = Instance.new("ImageButton")
                    local ChoosedCircleCorner = Instance.new("UICorner")
                    local ChoosedCircleStroke = Instance.new("UIStroke")

                    SelectableButton.Name = Text
                    SelectableButton.Parent = DropdownList
                    SelectableButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                    SelectableButton.BackgroundTransparency = 1
                    SelectableButton.BorderSizePixel = 0
                    SelectableButton.Position = UDim2.new(0.0412844047, 0, 0, 0)
                    SelectableButton.Size = UDim2.new(1, 0, 0, 40)
                    SelectableButton.AutoButtonColor = false
                    SelectableButton.Font = Enum.Font.SourceSansSemibold
                    SelectableButton.Text = ""
                    SelectableButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                    SelectableButton.TextSize = 16.000
                    SelectableButton.ZIndex = 12

                    SelectableText.Name = "SelectableText"
                    SelectableText.Parent = SelectableButton
                    SelectableText.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                    SelectableText.BackgroundTransparency = 1.000
                    SelectableText.BorderSizePixel = 0
                    SelectableText.Position = UDim2.new(0.0799999982, 0, 0, 0)
                    SelectableText.Size = UDim2.new(0.920000017, 0, 1, 0)
                    SelectableText.Font = Enum.Font.SourceSansSemibold
                    SelectableText.Text = "    " .. Text
                    SelectableText.TextColor3 = Color3.fromRGB(255, 255, 255)
                    SelectableText.TextSize = 18.000
                    SelectableText.TextWrapped = true
                    SelectableText.TextXAlignment = Enum.TextXAlignment.Left
                    SelectableText.ZIndex = 12

                    SelectableCorner.Parent = SelectableButton
                    SelectableCorner.CornerRadius = UDim.new(0, 3)

                    SecFrame.Parent = SelectableButton
                    SecFrame.AnchorPoint = Vector2.new(0.5, 0)
                    SecFrame.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
                    SecFrame.BorderSizePixel = 0
                    SecFrame.Position = UDim2.new(0.5, 24, 1, 0)
                    SecFrame.Size = UDim2.new(1, 0, 0, 1)
                    SecFrame.ZIndex = 12

                    ChoosedCircle.Name = "ChoosedCircle"
                    ChoosedCircle.Parent = SelectableButton
                    ChoosedCircle.AnchorPoint = Vector2.new(0, 0.5)
                    ChoosedCircle.BackgroundColor3 = Color3.fromRGB(0, 85, 255)
                    ChoosedCircle.BackgroundTransparency = 1.000
                    ChoosedCircle.BorderSizePixel = 0
                    ChoosedCircle.Position = UDim2.new(0, 5, 0.5, 0)
                    ChoosedCircle.Size = UDim2.new(0, 16, 0, 16)
                    ChoosedCircle.ZIndex = 13

                    InnerCircle.Name = "InnerCircle"
                    InnerCircle.Parent = ChoosedCircle
                    InnerCircle.AnchorPoint = Vector2.new(0.5, 0.5)
                    InnerCircle.BackgroundColor3 = Color3.fromRGB(0, 123, 255)
                    InnerCircle.BackgroundTransparency = 1.000
                    InnerCircle.BorderSizePixel = 0
                    InnerCircle.Position = UDim2.new(0.5, 0, 0.5, 0)
                    InnerCircle.Size = UDim2.new(0, 0, 0, 0)
                    InnerCircle.Image = "rbxassetid://3926305904"
                    InnerCircle.ImageRectOffset = Vector2.new(204, 484)
                    InnerCircle.ImageRectSize = Vector2.new(36, 36)
                    InnerCircle.ImageTransparency = 0
                    InnerCircle.ZIndex = 14

                    ChoosedCircleCorner.CornerRadius = UDim.new(0, 100)
                    ChoosedCircleCorner.Name = "ChoosedCircleCorner"
                    ChoosedCircleCorner.Parent = ChoosedCircle

                    ChoosedCircleStroke.Parent = ChoosedCircle
                    ChoosedCircleStroke.Name = "CircleStroke"
                    ChoosedCircleStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
                    ChoosedCircleStroke.LineJoinMode = Enum.LineJoinMode.Round
                    ChoosedCircleStroke.Thickness = 1.3
                    ChoosedCircleStroke.Transparency = 0
                    ChoosedCircleStroke.Color = Color3.fromRGB(44, 44, 44)

                    local isSelected = false
                    if not IsMulti then
                        isSelected = (SelectedValue == val or (val == nil and SelectedValue == Text))
                        if isSelected then
                            InnerCircle.Size = UDim2.new(0, 12, 0, 12)
                            ChoosedCircle.BackgroundTransparency = 0
                            ChoosedCircleStroke.Thickness = 0
                            DropdownBox.Text = Text
                        end
                    elseif IsMulti and Stored[Text] then
                        isSelected = true
                        InnerCircle.Size = UDim2.new(0, 12, 0, 12)
                        ChoosedCircle.BackgroundTransparency = 0
                        ChoosedCircleStroke.Thickness = 0
                    end
                    
                    SelectedItems[SelectableButton] = isSelected
                    table.insert(AllSelectables, {
                        button = SelectableButton,
                        text = Text,
                        value = val
                    })

                    library.Conn[#library.Conn + 1] = SelectableButton.MouseButton1Click:Connect(function()
                        if not IsMulti then
                            for btn, _ in pairs(SelectedItems) do
                                if btn and btn:IsA("TextButton") and btn ~= SelectableButton then
                                    SelectedItems[btn] = false
                                    local btnCircle = btn:FindFirstChild("ChoosedCircle")
                                    if btnCircle then
                                        tweensv:Create(btnCircle, TweenInfo.new(0.15), {BackgroundTransparency = 1}):Play()
                                        
                                        local circleStroke = btnCircle:FindFirstChild("CircleStroke")
                                        if circleStroke then
                                            tweensv:Create(circleStroke, TweenInfo.new(0.15), {Thickness = 1.3}):Play()
                                        end
                                        
                                        local innerCircle = btnCircle:FindFirstChild("InnerCircle")
                                        if innerCircle then
                                            innerCircle:TweenSize(UDim2.new(0, 0, 0, 0), "Out", "Sine", 0.15, true)
                                        end
                                    end
                                end
                            end
                            
                            SelectedItems[SelectableButton] = true
                            SelectedValue = val or Text
                            
                            dropdown.value = SelectedValue
                            
                            DropdownBox.Text = Text
                            
                            if func then
                                pcall(func, Text, val)
                            end
                            
                            InnerCircle:TweenSize(UDim2.new(0, 12, 0, 12), "In", "Sine", 0.15, true)
                            tweensv:Create(ChoosedCircle, TweenInfo.new(0.15), {BackgroundTransparency = 0}):Play()
                            tweensv:Create(ChoosedCircleStroke, TweenInfo.new(0.15), {Thickness = 0}):Play()
                            
                            tweensv:Create(ImageLabel, TweenInfo.new(0.3), {Rotation = 90}):Play()
                            Tsd:TweenPosition(UDim2.new(0.5, 0, 5, 0), "Out", "Quart", 0.3)
                            
                            if SearchBar then
                                SearchBar.Text = ""
                            end
                        else
                            local newState = not SelectedItems[SelectableButton]
                            SelectedItems[SelectableButton] = newState
                            
                            if newState then
                                InnerCircle:TweenSize(UDim2.new(0, 12, 0, 12), "In", "Sine", 0.15, true)
                                tweensv:Create(ChoosedCircle, TweenInfo.new(0.15), {BackgroundTransparency = 0}):Play()
                                tweensv:Create(ChoosedCircleStroke, TweenInfo.new(0.15), {Thickness = 0}):Play()
                                Stored[Text] = true
                            else
                                InnerCircle:TweenSize(UDim2.new(0, 0, 0, 0), "In", "Sine", 0.15, true)
                                tweensv:Create(ChoosedCircle, TweenInfo.new(0.15), {BackgroundTransparency = 1}):Play()
                                tweensv:Create(ChoosedCircleStroke, TweenInfo.new(0.15), {Thickness = 1.3}):Play()
                                Stored[Text] = nil
                            end
                            
                            dropdown.value = Stored
                            
                            if func then
                                pcall(func, Stored, newState)
                            end
                        end
                    end)

                    library.Conn[#library.Conn + 1] = SelectableButton.MouseEnter:Connect(function()
                        tweensv:Create(SelectableButton, TweenInfo.new(0.25), {BackgroundTransparency = 0.96}):Play()
                    end)
                    
                    library.Conn[#library.Conn + 1] = SelectableButton.MouseLeave:Connect(function()
                        tweensv:Create(SelectableButton, TweenInfo.new(0.25), {BackgroundTransparency = 1}):Play()
                    end)
                    
                    return SelectableButton
                end

                dropdown.set = function(self, selected)
                    if not self.options then
                        self.options = {}
                    end
                    
                    if selected == nil then
                        if IsMulti then
                            table.clear(Stored)
                            self.value = Stored
                        else
                            SelectedValue = nil
                            self.value = nil
                            DropdownBox.Text = placeholder
                        end
                        
                        for btn, _ in pairs(SelectedItems) do
                            if btn and btn:IsA("TextButton") then
                                SelectedItems[btn] = false
                                local circle = btn:FindFirstChild("ChoosedCircle")
                                if circle then
                                    circle.BackgroundTransparency = 1
                                    local innerCircle = circle:FindFirstChild("InnerCircle")
                                    if innerCircle then
                                        innerCircle.Size = UDim2.new(0, 0, 0, 0)
                                    end
                                    local stroke = circle:FindFirstChild("CircleStroke")
                                    if stroke then
                                        stroke.Thickness = 1.3
                                    end
                                end
                            end
                        end
                        
                        return self
                    end

                    if IsMulti and type(selected) == "table" then
                        table.clear(Stored)
                        for k, v in pairs(selected) do
                            Stored[k] = v
                        end
                        self.value = Stored
                        
                        for btn, _ in pairs(SelectedItems) do
                            if btn and btn:IsA("TextButton") then
                                local isSelected = selected[btn.Name] ~= nil
                                SelectedItems[btn] = isSelected
                                
                                local circle = btn:FindFirstChild("ChoosedCircle")
                                if circle then
                                    circle.BackgroundTransparency = isSelected and 0 or 1
                                    local innerCircle = circle:FindFirstChild("InnerCircle")
                                    if innerCircle then
                                        innerCircle.Size = isSelected and UDim2.new(0, 12, 0, 12) or UDim2.new(0, 0, 0, 0)
                                    end
                                    local stroke = circle:FindFirstChild("CircleStroke")
                                    if stroke then
                                        stroke.Thickness = isSelected and 0 or 1.3
                                    end
                                end
                            end
                        end
                    else
                        SelectedValue = selected
                        self.value = selected
                        local found = false
                        
                        for _, option in pairs(self.options) do
                            local optionValue = (type(option) == "table") and option.value or option
                            local optionText = (type(option) == "table") and (option.text or tostring(option.value)) or tostring(option)
                            
                            if optionValue == selected or optionText == selected then
                                DropdownBox.Text = optionText
                                found = true
                                
                                for btn, _ in pairs(SelectedItems) do
                                    if btn and btn:IsA("TextButton") then
                                        local isSelected = (btn.Name == optionText)
                                        SelectedItems[btn] = isSelected
                                        
                                        local circle = btn:FindFirstChild("ChoosedCircle")
                                        if circle then
                                            circle.BackgroundTransparency = isSelected and 0 or 1
                                            local innerCircle = circle:FindFirstChild("InnerCircle")
                                            if innerCircle then
                                                innerCircle.Size = isSelected and UDim2.new(0, 12, 0, 12) or UDim2.new(0, 0, 0, 0)
                                            end
                                            local stroke = circle:FindFirstChild("CircleStroke")
                                            if stroke then
                                                stroke.Thickness = isSelected and 0 or 1.3
                                            end
                                        end
                                    end
                                end
                                
                                break
                            end
                        end
                        
                        if not found then
                            DropdownBox.Text = tostring(selected)
                        end
                    end
                    
                    return self
                end
                
                dropdown.Refresh = function(self, newOptions, selected)
                    if not DropdownList then return self end
                    
                    for _, child in pairs(DropdownList:GetChildren()) do
                        if child:IsA("TextButton") then
                            child:Destroy()
                        end
                    end
                    
                    table.clear(SelectedItems)
                    table.clear(AllSelectables)
                    
                    if IsMulti then
                        table.clear(Stored)
                    end
                    
                    if newOptions then
                        self.options = newOptions
                    end
                    
                    if selected ~= nil then
                        self.value = selected
                        SelectedValue = selected
                    end
                    
                    for _, option in pairs(self.options) do
                        if type(option) == "table" then
                            NewSelectable(option.text or tostring(option.value), option.value)
                        else
                            NewSelectable(tostring(option), option)
                        end
                    end
                    
                    self:set(self.value)
                    
                    return self
                end
                
                dropdown.RemoveOptions = function(self)
                    return self:Refresh({})
                end
                
                dropdown.AddOption = function(self, option)
                    local newOptions = {}
                    
                    for _, opt in pairs(self.options) do
                        table.insert(newOptions, opt)
                    end
                    
                    table.insert(newOptions, option)
                    
                    return self:Refresh(newOptions, self.value)
                end

                if not library.flags then library.flags = {} end
                library.flags[flag] = dropdown

                library.Conn[#library.Conn + 1] = DropdownBox.MouseButton1Click:Connect(function()
                    tweensv:Create(ImageLabel, TweenInfo.new(0.3), {Rotation = 180}):Play()
                    Tsd:TweenPosition(UDim2.new(0.5, 0, 0.5, 0), "Out", "Quart", 0.3)
                    if SearchBar then
                        SearchBar.Text = ""
                    end
                end)
                
                library.Conn[#library.Conn + 1] = CloseButton.MouseButton1Click:Connect(function()
                    tweensv:Create(ImageLabel, TweenInfo.new(0.3), {Rotation = 90}):Play()
                    Tsd:TweenPosition(UDim2.new(0.5, 0, 5, 0), "Out", "Quart", 0.3)
                    if SearchBar then
                        SearchBar.Text = ""
                    end
                end)
                
                if EnableSearch == true and SearchBar then
                    library.Conn[#library.Conn + 1] = SearchBar:GetPropertyChangedSignal("Text"):Connect(function()
                        local searchText = string.lower(SearchBar.Text)
                        if searchText == "" then
                            for _, item in pairs(AllSelectables) do
                                item.button.Visible = true
                            end
                        else
                            for _, item in pairs(AllSelectables) do
                                local matches = string.find(string.lower(item.text), searchText) ~= nil
                                item.button.Visible = matches
                            end
                        end
                    end)
                    
                    library.Conn[#library.Conn + 1] = SearchBar.FocusLost:Connect(function(enterPressed)
                        if enterPressed then
                            local searchText = string.lower(SearchBar.Text)
                            local firstMatch = nil
                            
                            for _, item in pairs(AllSelectables) do
                                if string.find(string.lower(item.text), searchText) ~= nil then
                                    firstMatch = item
                                    break
                                end
                            end
                            
                            if firstMatch and not IsMulti then
                                for btn, _ in pairs(SelectedItems) do
                                    if btn and btn:IsA("TextButton") then
                                        SelectedItems[btn] = false
                                        local circle = btn:FindFirstChild("ChoosedCircle")
                                        if circle then
                                            circle.BackgroundTransparency = 1
                                            local innerCircle = circle:FindFirstChild("InnerCircle")
                                            if innerCircle then
                                                innerCircle.Size = UDim2.new(0, 0, 0, 0)
                                            end
                                            local stroke = circle:FindFirstChild("CircleStroke")
                                            if stroke then
                                                stroke.Thickness = 1.3
                                            end
                                        end
                                    end
                                end
                                
                                SelectedItems[firstMatch.button] = true
                                SelectedValue = firstMatch.value or firstMatch.text
                                dropdown.value = SelectedValue
                                DropdownBox.Text = firstMatch.text
                                
                                local circle = firstMatch.button:FindFirstChild("ChoosedCircle")
                                if circle then
                                    circle.BackgroundTransparency = 0
                                    local innerCircle = circle:FindFirstChild("InnerCircle")
                                    if innerCircle then
                                        innerCircle.Size = UDim2.new(0, 12, 0, 12)
                                    end
                                    local stroke = circle:FindFirstChild("CircleStroke")
                                    if stroke then
                                        stroke.Thickness = 0
                                    end
                                end
                                
                                if func then
                                    pcall(func, firstMatch.text, firstMatch.value)
                                end
                                
                                tweensv:Create(ImageLabel, TweenInfo.new(0.3), {Rotation = 90}):Play()
                                Tsd:TweenPosition(UDim2.new(0.5, 0, 5, 0), "Out", "Quart", 0.3)
                                SearchBar.Text = ""
                            end
                        end
                    end)
                end

                dropdown:Refresh(Selectables)

                if Tab and TabLayout then
                    Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                end
                
                return dropdown
            end

        function tabcontent:Colorpicker(text, preset, callback, flag)
                        local flag = flag or text
                        local ColorPickerToggled = false
                        local OldToggleColor = Color3.fromRGB(0, 0, 0)
                        local OldColor = Color3.fromRGB(0, 0, 0)
                        local OldColorSelectionPosition = nil
                        local OldHueSelectionPosition = nil
                        local ColorH, ColorS, ColorV = 1, 1, 1
                        local RainbowColorPicker = false
                        local ColorPickerInput = nil
                        local ColorInput = nil
                        local HueInput = nil
                        local isDraggingSpeed = false

                        if not library.RainbowRegistry then
                            library.RainbowRegistry = {
                                pickers = {},
                                speed = 0.3,
                                connection = nil
                            }
                            
                            local function updateRainbowColors()
                                if #library.RainbowRegistry.pickers == 0 then
                                    if library.RainbowRegistry.connection then
                                        library.RainbowRegistry.connection:Disconnect()
                                        library.RainbowRegistry.connection = nil
                                    end
                                    return
                                end
                                
                                if not library.RainbowRegistry.connection then
                                    local startTime = tick()
                                    library.RainbowRegistry.connection = rs.RenderStepped:Connect(function()
                                        local timeElapsed = (tick() - startTime) * library.RainbowRegistry.speed
                                        local hue = (math.sin(timeElapsed) + 1) / 2
                                        local rainbowColor = Color3.fromHSV(hue, 1, 1)
                                        
                                        for _, picker in ipairs(library.RainbowRegistry.pickers) do
                                            if picker.boxColor and picker.colorPanel and picker.callback and picker.hueSelection and picker.colorSelection then
                                                picker.boxColor.BackgroundColor3 = rainbowColor
                                                picker.colorPanel.BackgroundColor3 = rainbowColor
                                                picker.colorSelection.Position = UDim2.new(1, 0, 0, 0)
                                                picker.hueSelection.Position = UDim2.new(0.48, 0, 1 - hue, 0)
                                                picker.instance.value = rainbowColor
                                                pcall(picker.callback, rainbowColor)
                                            end
                                        end
                                    end)
                                end
                            end
                            
                            library.RainbowRegistry.updateRainbowColors = updateRainbowColors
                        end

                        local Colorpicker = Instance.new("Frame")
                        local ColorpickerCorner = Instance.new("UICorner")
                        local ColorpickerTitle = Instance.new("TextLabel")
                        local BoxColor = Instance.new("Frame")
                        local BoxColorCorner = Instance.new("UICorner")
                        local ConfirmBtn = Instance.new("TextButton")
                        local ConfirmBtnCorner = Instance.new("UICorner")
                        local ConfirmBtnTitle = Instance.new("TextLabel")
                        local ColorpickerBtn = Instance.new("TextButton")
                        local RainbowToggle = Instance.new("TextButton")
                        local RainbowToggleCorner = Instance.new("UICorner")
                        local RainbowToggleTitle = Instance.new("TextLabel")
                        local FrameRainbowToggle1 = Instance.new("Frame")
                        local FrameRainbowToggle1Corner = Instance.new("UICorner")
                        local FrameRainbowToggle2 = Instance.new("Frame")
                        local FrameRainbowToggle2_2 = Instance.new("UICorner")
                        local FrameRainbowToggle3 = Instance.new("Frame")
                        local FrameToggle3 = Instance.new("UICorner")
                        local FrameRainbowToggleCircle = Instance.new("Frame")
                        local FrameRainbowToggleCircleCorner = Instance.new("UICorner")
                        local Color = Instance.new("ImageLabel")
                        local ColorCorner = Instance.new("UICorner")
                        local ColorSelection = Instance.new("ImageLabel")
                        local Hue = Instance.new("ImageLabel")
                        local HueCorner = Instance.new("UICorner")
                        local HueGradient = Instance.new("UIGradient")
                        local HueSelection = Instance.new("ImageLabel")
                        
                        local RainbowSpeedSlider = Instance.new("Frame")
                        local RainbowSpeedSliderCorner = Instance.new("UICorner")
                        local RainbowSpeedSliderBar = Instance.new("Frame")
                        local RainbowSpeedSliderBarCorner = Instance.new("UICorner")
                        local RainbowSpeedSliderCircle = Instance.new("Frame")
                        local RainbowSpeedSliderCircleCorner = Instance.new("UICorner")
                        local RainbowSpeedLabel = Instance.new("TextLabel")

                        Colorpicker.Name = "Colorpicker"
                        Colorpicker.Parent = Tab
                        Colorpicker.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
                        Colorpicker.ClipsDescendants = true
                        Colorpicker.Position = UDim2.new(-0.541071415, 0, -0.532915354, 0)
                        Colorpicker.Size = UDim2.new(0, 363, 0, 42)

                        ColorpickerCorner.CornerRadius = UDim.new(0, 5)
                        ColorpickerCorner.Name = "ColorpickerCorner"
                        ColorpickerCorner.Parent = Colorpicker

                        ColorpickerTitle.Name = "ColorpickerTitle"
                        ColorpickerTitle.Parent = Colorpicker
                        ColorpickerTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        ColorpickerTitle.BackgroundTransparency = 1.000
                        ColorpickerTitle.Position = UDim2.new(0.0358126722, 0, 0, 0)
                        ColorpickerTitle.Size = UDim2.new(0, 187, 0, 42)
                        ColorpickerTitle.Font = Enum.Font.SourceSans
                        ColorpickerTitle.Text = text
                        ColorpickerTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
                        ColorpickerTitle.TextSize = 18
                        ColorpickerTitle.TextXAlignment = Enum.TextXAlignment.Left

                        BoxColor.Name = "BoxColor"
                        BoxColor.Parent = ColorpickerTitle
                        BoxColor.BackgroundColor3 = preset or Color3.fromRGB(255, 0, 4)
                        BoxColor.Position = UDim2.new(1.60427809, 0, 0.214285716, 0)
                        BoxColor.Size = UDim2.new(0, 41, 0, 23)

                        BoxColorCorner.CornerRadius = UDim.new(0, 5)
                        BoxColorCorner.Name = "BoxColorCorner"
                        BoxColorCorner.Parent = BoxColor

                        ConfirmBtn.Name = "ConfirmBtn"
                        ConfirmBtn.Parent = ColorpickerTitle
                        ConfirmBtn.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
                        ConfirmBtn.Position = UDim2.new(1.25814295, 0, 1.09037197, 0)
                        ConfirmBtn.Size = UDim2.new(0, 105, 0, 32)
                        ConfirmBtn.AutoButtonColor = false
                        ConfirmBtn.Font = Enum.Font.SourceSans
                        ConfirmBtn.Text = ""
                        ConfirmBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
                        ConfirmBtn.TextSize = 14.000

                        ConfirmBtnCorner.CornerRadius = UDim.new(0, 5)
                        ConfirmBtnCorner.Name = "ConfirmBtnCorner"
                        ConfirmBtnCorner.Parent = ConfirmBtn

                        ConfirmBtnTitle.Name = "ConfirmBtnTitle"
                        ConfirmBtnTitle.Parent = ConfirmBtn
                        ConfirmBtnTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        ConfirmBtnTitle.BackgroundTransparency = 1.000
                        ConfirmBtnTitle.Size = UDim2.new(0, 33, 0, 32)
                        ConfirmBtnTitle.Font = Enum.Font.Gotham
                        ConfirmBtnTitle.Text = "Confirm"
                        ConfirmBtnTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
                        ConfirmBtnTitle.TextSize = 14.000
                        ConfirmBtnTitle.TextXAlignment = Enum.TextXAlignment.Left

                        ColorpickerBtn.Name = "ColorpickerBtn"
                        ColorpickerBtn.Parent = ColorpickerTitle
                        ColorpickerBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        ColorpickerBtn.BackgroundTransparency = 1.000
                        ColorpickerBtn.Size = UDim2.new(0, 363, 0, 42)
                        ColorpickerBtn.Font = Enum.Font.SourceSans
                        ColorpickerBtn.Text = ""
                        ColorpickerBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
                        ColorpickerBtn.TextSize = 14.000

                        RainbowToggle.Name = "RainbowToggle"
                        RainbowToggle.Parent = ColorpickerTitle
                        RainbowToggle.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
                        RainbowToggle.Position = UDim2.new(1.26349044, 0, 2.12684202, 0)
                        RainbowToggle.Size = UDim2.new(0, 104, 0, 32)
                        RainbowToggle.AutoButtonColor = false
                        RainbowToggle.Font = Enum.Font.SourceSans
                        RainbowToggle.Text = ""
                        RainbowToggle.TextColor3 = Color3.fromRGB(0, 0, 0)
                        RainbowToggle.TextSize = 14.000

                        RainbowToggleCorner.CornerRadius = UDim.new(0, 5)
                        RainbowToggleCorner.Name = "RainbowToggleCorner"
                        RainbowToggleCorner.Parent = RainbowToggle

                        RainbowToggleTitle.Name = "RainbowToggleTitle"
                        RainbowToggleTitle.Parent = RainbowToggle
                        RainbowToggleTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        RainbowToggleTitle.BackgroundTransparency = 1.000
                        RainbowToggleTitle.Size = UDim2.new(0, 33, 0, 32)
                        RainbowToggleTitle.Font = Enum.Font.Gotham
                        RainbowToggleTitle.Text = "Rainbow"
                        RainbowToggleTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
                        RainbowToggleTitle.TextSize = 14.000
                        RainbowToggleTitle.TextXAlignment = Enum.TextXAlignment.Left

                        FrameRainbowToggle1.Name = "FrameRainbowToggle1"
                        FrameRainbowToggle1.Parent = RainbowToggle
                        FrameRainbowToggle1.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                        FrameRainbowToggle1.Position = UDim2.new(0.649999976, 0, 0.186000004, 0)
                        FrameRainbowToggle1.Size = UDim2.new(0, 37, 0, 18)

                        FrameRainbowToggle1Corner.Name = "FrameRainbowToggle1Corner"
                        FrameRainbowToggle1Corner.Parent = FrameRainbowToggle1

                        FrameRainbowToggle2.Name = "FrameRainbowToggle2"
                        FrameRainbowToggle2.Parent = FrameRainbowToggle1
                        FrameRainbowToggle2.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
                        FrameRainbowToggle2.Position = UDim2.new(0.0590000004, 0, 0.112999998, 0)
                        FrameRainbowToggle2.Size = UDim2.new(0, 33, 0, 14)

                        FrameRainbowToggle2_2.Name = "FrameRainbowToggle2"
                        FrameRainbowToggle2_2.Parent = FrameRainbowToggle2

                        FrameRainbowToggle3.Name = "FrameRainbowToggle3"
                        FrameRainbowToggle3.Parent = FrameRainbowToggle1
                        FrameRainbowToggle3.BackgroundColor3 = PresetColor
                        FrameRainbowToggle3.BackgroundTransparency = 1.000
                        FrameRainbowToggle3.Size = UDim2.new(0, 37, 0, 18)

                        FrameToggle3.Name = "FrameToggle3"
                        FrameToggle3.Parent = FrameRainbowToggle3

                        FrameRainbowToggleCircle.Name = "FrameRainbowToggleCircle"
                        FrameRainbowToggleCircle.Parent = FrameRainbowToggle1
                        FrameRainbowToggleCircle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                        FrameRainbowToggleCircle.Position = UDim2.new(0.127000004, 0, 0.222000003, 0)
                        FrameRainbowToggleCircle.Size = UDim2.new(0, 10, 0, 10)

                        FrameRainbowToggleCircleCorner.Name = "FrameRainbowToggleCircleCorner"
                        FrameRainbowToggleCircleCorner.Parent = FrameRainbowToggleCircle

                        Color.Name = "Color"
                        Color.Parent = ColorpickerTitle
                        Color.BackgroundColor3 = preset or Color3.fromRGB(255, 0, 4)
                        Color.Position = UDim2.new(0, 0, 0, 42)
                        Color.Size = UDim2.new(0, 194, 0, 80)
                        Color.ZIndex = 10
                        Color.Image = "rbxassetid://4155801252"

                        ColorCorner.CornerRadius = UDim.new(0, 3)
                        ColorCorner.Name = "ColorCorner"
                        ColorCorner.Parent = Color

                        ColorSelection.Name = "ColorSelection"
                        ColorSelection.Parent = Color
                        ColorSelection.AnchorPoint = Vector2.new(0.5, 0.5)
                        ColorSelection.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        ColorSelection.BackgroundTransparency = 1.000
                        ColorSelection.Position = UDim2.new(preset and select(3, Color3.toHSV(preset)))
                        ColorSelection.Size = UDim2.new(0, 18, 0, 18)
                        ColorSelection.Image = "http://www.roblox.com/asset/?id=4805639000"
                        ColorSelection.ScaleType = Enum.ScaleType.Fit
                        ColorSelection.Visible = false

                        Hue.Name = "Hue"
                        Hue.Parent = ColorpickerTitle
                        Hue.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        Hue.Position = UDim2.new(0, 202, 0, 42)
                        Hue.Size = UDim2.new(0, 25, 0, 80)

                        HueCorner.CornerRadius = UDim.new(0, 3)
                        HueCorner.Name = "HueCorner"
                        HueCorner.Parent = Hue

                        HueGradient.Color =
                            ColorSequence.new {
                            ColorSequenceKeypoint.new(0.00, Color3.fromRGB(255, 0, 4)),
                            ColorSequenceKeypoint.new(0.20, Color3.fromRGB(234, 255, 0)),
                            ColorSequenceKeypoint.new(0.40, Color3.fromRGB(21, 255, 0)),
                            ColorSequenceKeypoint.new(0.60, Color3.fromRGB(0, 255, 255)),
                            ColorSequenceKeypoint.new(0.80, Color3.fromRGB(0, 17, 255)),
                            ColorSequenceKeypoint.new(0.90, Color3.fromRGB(255, 0, 251)),
                            ColorSequenceKeypoint.new(1.00, Color3.fromRGB(255, 0, 4))
                        }
                        HueGradient.Rotation = 270
                        HueGradient.Name = "HueGradient"
                        HueGradient.Parent = Hue

                        HueSelection.Name = "HueSelection"
                        HueSelection.Parent = Hue
                        HueSelection.AnchorPoint = Vector2.new(0.5, 0.5)
                        HueSelection.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        HueSelection.BackgroundTransparency = 1.000
                        HueSelection.Position = UDim2.new(0.48, 0, 1 - select(1, Color3.toHSV(preset or Color3.fromRGB(255, 0, 4))))
                        HueSelection.Size = UDim2.new(0, 18, 0, 18)
                        HueSelection.Image = "http://www.roblox.com/asset/?id=4805639000"
                        HueSelection.Visible = false
                        
                        RainbowSpeedSlider.Name = "RainbowSpeedSlider"
                        RainbowSpeedSlider.Parent = ColorpickerTitle
                        RainbowSpeedSlider.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
                        RainbowSpeedSlider.Position = UDim2.new(1.26349044, 0, 3.15, 0)
                        RainbowSpeedSlider.Size = UDim2.new(0, 104, 0, 32)
                        RainbowSpeedSlider.Visible = false

                        RainbowSpeedSliderCorner.CornerRadius = UDim.new(0, 5)
                        RainbowSpeedSliderCorner.Name = "RainbowSpeedSliderCorner"
                        RainbowSpeedSliderCorner.Parent = RainbowSpeedSlider

                        RainbowSpeedLabel.Name = "RainbowSpeedLabel"
                        RainbowSpeedLabel.Parent = RainbowSpeedSlider
                        RainbowSpeedLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                        RainbowSpeedLabel.BackgroundTransparency = 1.000
                        RainbowSpeedLabel.Position = UDim2.new(0, 0, 0, 0)
                        RainbowSpeedLabel.Size = UDim2.new(0, 104, 0, 15)
                        RainbowSpeedLabel.Font = Enum.Font.Gotham
                        RainbowSpeedLabel.Text = "Speed: " .. string.format("%.1f", library.RainbowRegistry.speed) .. "x"
                        RainbowSpeedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                        RainbowSpeedLabel.TextSize = 12.000

                        RainbowSpeedSliderBar.Name = "RainbowSpeedSliderBar"
                        RainbowSpeedSliderBar.Parent = RainbowSpeedSlider
                        RainbowSpeedSliderBar.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                        RainbowSpeedSliderBar.Position = UDim2.new(0.05, 0, 0.65, 0)
                        RainbowSpeedSliderBar.Size = UDim2.new(0, 94, 0, 4)

                        RainbowSpeedSliderBarCorner.CornerRadius = UDim.new(1, 0)
                        RainbowSpeedSliderBarCorner.Name = "RainbowSpeedSliderBarCorner"
                        RainbowSpeedSliderBarCorner.Parent = RainbowSpeedSliderBar

                        RainbowSpeedSliderCircle.Name = "RainbowSpeedSliderCircle"
                        RainbowSpeedSliderCircle.Parent = RainbowSpeedSliderBar
                        RainbowSpeedSliderCircle.BackgroundColor3 = PresetColor
                        RainbowSpeedSliderCircle.Size = UDim2.new(0, 10, 0, 10)
                        RainbowSpeedSliderCircle.ZIndex = 16

                        local initialPosition = math.clamp((library.RainbowRegistry.speed - 0.1) / 2.9, 0, 1)
                        RainbowSpeedSliderCircle.Position = UDim2.new(initialPosition, -5, 0.5, -5)

                        RainbowSpeedSliderCircleCorner.CornerRadius = UDim.new(1, 0)
                        RainbowSpeedSliderCircleCorner.Name = "RainbowSpeedSliderCircleCorner"
                        RainbowSpeedSliderCircleCorner.Parent = RainbowSpeedSliderCircle

                        coroutine.wrap(function()
                            while getgenv().libloaded do
                                FrameRainbowToggle3.BackgroundColor3 = PresetColor
                                RainbowSpeedSliderCircle.BackgroundColor3 = PresetColor
                                task.wait()
                            end
                        end)()

                        local function updateSpeedSlider(speed)
                            speed = math.clamp(speed, 0.1, 3)
                            library.RainbowRegistry.speed = speed

                            local position = math.clamp((speed - 0.1) / 2.9, 0, 1)
                            RainbowSpeedSliderCircle.Position = UDim2.new(position, -5, 0.5, -5)
                            RainbowSpeedLabel.Text = "Speed: " .. string.format("%.1f", speed) .. "x"

                            if library.RainbowRegistry.connection then
                                library.RainbowRegistry.connection:Disconnect()
                                library.RainbowRegistry.connection = nil
                                library.RainbowRegistry.updateRainbowColors()
                            end
                        end

                        local colorpicker = {
                            value = preset or Color3.fromRGB(255, 0, 4),
                            rainbow = false,
                            instance = {
                                boxColor = BoxColor,
                                colorPanel = Color,
                                hueSelection = HueSelection,
                                colorSelection = ColorSelection,
                                callback = callback
                            }
                        }

                        if not library.flags then library.flags = {} end
                        library.flags[flag] = colorpicker

                        local function UpdateColorPicker(nope)
                            BoxColor.BackgroundColor3 = Color3.fromHSV(ColorH, ColorS, ColorV)
                            Color.BackgroundColor3 = Color3.fromHSV(ColorH, 1, 1)
                            
                            colorpicker.value = BoxColor.BackgroundColor3
                            pcall(callback, BoxColor.BackgroundColor3)
                        end

                        ColorH = 1 - (math.clamp(HueSelection.AbsolutePosition.Y - Hue.AbsolutePosition.Y, 0, Hue.AbsoluteSize.Y) / Hue.AbsoluteSize.Y)
                        ColorS = (math.clamp(ColorSelection.AbsolutePosition.X - Color.AbsolutePosition.X, 0, Color.AbsoluteSize.X) / Color.AbsoluteSize.X)
                        ColorV = 1 - (math.clamp(ColorSelection.AbsolutePosition.Y - Color.AbsolutePosition.Y, 0, Color.AbsoluteSize.Y) / Color.AbsoluteSize.Y)

                        BoxColor.BackgroundColor3 = preset or Color3.fromRGB(255, 0, 4)
                        Color.BackgroundColor3 = preset or Color3.fromRGB(255, 0, 4)
                        colorpicker.value = BoxColor.BackgroundColor3
                        pcall(callback, BoxColor.BackgroundColor3)

                        colorpicker.set = function(self, color)
                            if typeof(color) ~= "Color3" then return end
                            if self.rainbow then
                                local pickerIndex = nil
                                for i, picker in ipairs(library.RainbowRegistry.pickers) do
                                    if picker.instance == colorpicker then
                                        pickerIndex = i
                                        break
                                    end
                                end
                                
                                if pickerIndex then
                                    table.remove(library.RainbowRegistry.pickers, pickerIndex)
                                    if #library.RainbowRegistry.pickers == 0 and library.RainbowRegistry.connection then
                                        library.RainbowRegistry.connection:Disconnect()
                                        library.RainbowRegistry.connection = nil
                                    end
                                end
                                
                                RainbowColorPicker = false
                                self.rainbow = false
                                tweensv:Create(FrameRainbowToggle1, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
                                tweensv:Create(FrameRainbowToggle2, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
                                tweensv:Create(FrameRainbowToggle3, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 1}):Play()
                                tweensv:Create(FrameRainbowToggleCircle, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundColor3 = Color3.fromRGB(50, 50, 50)}):Play()
                                FrameRainbowToggleCircle.Position = UDim2.new(0.127000004, 0, 0.222000003, 0)
                                RainbowSpeedSlider.Visible = false
                                if ColorPickerToggled then
                                    Colorpicker.Size = UDim2.new(0, 363, 0, 132)
                                    Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                                end
                            end
                            
                            self.value = color
                            BoxColor.BackgroundColor3 = color
                            Color.BackgroundColor3 = color
                            local h, s, v = Color3.toHSV(color)
                            ColorH, ColorS, ColorV = h, s, v
                            ColorSelection.Position = UDim2.new(s, 0, 1 - v, 0)
                            HueSelection.Position = UDim2.new(0.48, 0, 1 - h, 0)
                            OldToggleColor = color
                            OldColor = color
                            OldColorSelectionPosition = ColorSelection.Position
                            OldHueSelectionPosition = HueSelection.Position
                            pcall(callback, color)
                            return self
                        end
                        
                        colorpicker.setRainbow = function(self, state)
                            RainbowColorPicker = state
                            self.rainbow = state
                            
                            if state then
                                OldToggleColor = BoxColor.BackgroundColor3
                                OldColor = Color.BackgroundColor3
                                OldColorSelectionPosition = ColorSelection.Position
                                OldHueSelectionPosition = HueSelection.Position
                                
                                tweensv:Create(FrameRainbowToggle1, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 1}):Play()
                                tweensv:Create(FrameRainbowToggle2, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 1}):Play()
                                tweensv:Create(FrameRainbowToggle3, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
                                tweensv:Create(FrameRainbowToggleCircle, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundColor3 = Color3.fromRGB(255, 255, 255)}):Play()
                                FrameRainbowToggleCircle.Position = UDim2.new(0.587, 0, 0.222000003, 0)
                                
                                RainbowSpeedSlider.Visible = ColorPickerToggled
                                if ColorPickerToggled then
                                    Colorpicker.Size = UDim2.new(0, 363, 0, 172)
                                    Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                                end
                                
                                table.insert(library.RainbowRegistry.pickers, {
                                    boxColor = BoxColor,
                                    colorPanel = Color,
                                    callback = callback,
                                    hueSelection = HueSelection,
                                    colorSelection = ColorSelection,
                                    instance = colorpicker
                                })
                                
                                library.RainbowRegistry.updateRainbowColors()
                            else
                                local pickerIndex = nil
                                for i, picker in ipairs(library.RainbowRegistry.pickers) do
                                    if picker.instance == colorpicker then
                                        pickerIndex = i
                                        break
                                    end
                                end
                                
                                if pickerIndex then
                                    table.remove(library.RainbowRegistry.pickers, pickerIndex)
                                    if #library.RainbowRegistry.pickers == 0 and library.RainbowRegistry.connection then
                                        library.RainbowRegistry.connection:Disconnect()
                                        library.RainbowRegistry.connection = nil
                                    end
                                end
                                
                                tweensv:Create(FrameRainbowToggle1, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
                                tweensv:Create(FrameRainbowToggle2, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0}):Play()
                                tweensv:Create(FrameRainbowToggle3, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 1}):Play()
                                tweensv:Create(FrameRainbowToggleCircle, TweenInfo.new(.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundColor3 = Color3.fromRGB(50, 50, 50)}):Play()
                                FrameRainbowToggleCircle.Position = UDim2.new(0.127000004, 0, 0.222000003, 0)
                                
                                RainbowSpeedSlider.Visible = false
                                if ColorPickerToggled then
                                    Colorpicker.Size = UDim2.new(0, 363, 0, 132)
                                    Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                                end
                                
                                BoxColor.BackgroundColor3 = OldToggleColor
                                Color.BackgroundColor3 = OldColor
                                ColorSelection.Position = OldColorSelectionPosition
                                HueSelection.Position = OldHueSelectionPosition
                                self.value = BoxColor.BackgroundColor3
                                
                                pcall(callback, BoxColor.BackgroundColor3)
                            end
                            return self
                        end
                        
                        colorpicker.setRainbowSpeed = function(self, speed)
                            updateSpeedSlider(speed)
                            return self
                        end

                        library.Conn[#library.Conn + 1] = Color.InputBegan:Connect(function(input)
                            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                                if RainbowColorPicker then return end

                                if ColorInput then
                                    ColorInput:Disconnect()
                                end

                                ColorInput = rs.RenderStepped:Connect(function()
                                    local ColorX = (math.clamp(ms.X - Color.AbsolutePosition.X, 0, Color.AbsoluteSize.X) / Color.AbsoluteSize.X)
                                    local ColorY = (math.clamp(ms.Y - Color.AbsolutePosition.Y, 0, Color.AbsoluteSize.Y) / Color.AbsoluteSize.Y)

                                    ColorSelection.Position = UDim2.new(ColorX, 0, ColorY, 0)
                                    ColorS = ColorX
                                    ColorV = 1 - ColorY

                                    UpdateColorPicker(true)
                                end)
                            end
                        end)

                        library.Conn[#library.Conn + 1] = Color.InputEnded:Connect(function(input)
                            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                                if ColorInput then
                                    ColorInput:Disconnect()
                                end
                            end
                        end)

                        library.Conn[#library.Conn + 1] = Hue.InputBegan:Connect(function(input)
                            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                                if RainbowColorPicker then return end

                                if HueInput then
                                    HueInput:Disconnect()
                                end

                                HueInput = rs.RenderStepped:Connect(function()
                                    local HueY = (math.clamp(ms.Y - Hue.AbsolutePosition.Y, 0, Hue.AbsoluteSize.Y) / Hue.AbsoluteSize.Y)

                                    HueSelection.Position = UDim2.new(0.48, 0, HueY, 0)
                                    ColorH = 1 - HueY

                                    UpdateColorPicker(true)
                                end)
                            end
                        end)

                        library.Conn[#library.Conn + 1] = Hue.InputEnded:Connect(function(input)
                            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                                if HueInput then
                                    HueInput:Disconnect()
                                end
                            end
                        end)
                        
                        library.Conn[#library.Conn + 1] = RainbowToggle.MouseButton1Click:Connect(function()
                            colorpicker:setRainbow(not RainbowColorPicker)
                        end)

                        library.Conn[#library.Conn + 1] = ColorpickerBtn.MouseButton1Click:Connect(function()
                            if ColorPickerToggled == false then
                                ColorSelection.Visible = true
                                HueSelection.Visible = true
                                Colorpicker.Size = UDim2.new(0, 363, 0, RainbowColorPicker and 172 or 132)
                                if RainbowColorPicker then
                                    RainbowSpeedSlider.Visible = true
                                end
                                wait(.2)
                                Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                            else
                                ColorSelection.Visible = false
                                HueSelection.Visible = false
                                RainbowSpeedSlider.Visible = false
                                Colorpicker.Size = UDim2.new(0, 363, 0, 42)
                                wait(.2)
                                Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                            end
                            ColorPickerToggled = not ColorPickerToggled
                        end)

                        library.Conn[#library.Conn + 1] = ConfirmBtn.MouseButton1Click:Connect(function()
                            ColorSelection.Visible = false
                            HueSelection.Visible = false
                            RainbowSpeedSlider.Visible = false
                            Colorpicker.Size = UDim2.new(0, 363, 0, 42)
                            wait(.2)
                            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                            ColorPickerToggled = false
                        end)

                        local speedSliderConnection = nil
                        
                        local function startSpeedDrag(inputPosition)
                            isDraggingSpeed = true
                            local function updateSpeed(pos)
                                local mouseX = pos.X
                                local barX = RainbowSpeedSliderBar.AbsolutePosition.X
                                local barWidth = RainbowSpeedSliderBar.AbsoluteSize.X
                                
                                local relativeX = math.clamp((mouseX - barX) / barWidth, 0, 1)
                                local speed = 0.1 + (relativeX * 2.9)
                                updateSpeedSlider(speed)
                            end
                            
                            updateSpeed(inputPosition)
                            
                            if speedSliderConnection then
                                speedSliderConnection:Disconnect()
                            end
                            
                            speedSliderConnection = uis.InputChanged:Connect(function(input)
                                if input.UserInputType == Enum.UserInputType.MouseMovement then
                                    updateSpeed(input.Position)
                                end
                            end)
                        end
                        
                        local function endSpeedDrag()
                            isDraggingSpeed = false
                            if speedSliderConnection then
                                speedSliderConnection:Disconnect()
                                speedSliderConnection = nil
                            end
                        end

                        library.Conn[#library.Conn + 1] = RainbowSpeedSliderBar.InputBegan:Connect(function(input)
                            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                                startSpeedDrag(input.Position)
                            end
                        end)
                        
                        library.Conn[#library.Conn + 1] = RainbowSpeedSliderBar.InputEnded:Connect(function(input)
                            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                                endSpeedDrag()
                            end
                        end)

                        library.Conn[#library.Conn + 1] = RainbowSpeedSlider.InputBegan:Connect(function(input)
                            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                                startSpeedDrag(input.Position)
                            end
                        end)
                        
                        library.Conn[#library.Conn + 1] = RainbowSpeedSlider.InputEnded:Connect(function(input)
                            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                                endSpeedDrag()
                            end
                        end)

                        library.Conn[#library.Conn + 1] = Colorpicker.Destroying:Connect(function()
                            if speedSliderConnection then
                                speedSliderConnection:Disconnect()
                            end
                            
                            if colorpicker.rainbow then
                                local pickerIndex = nil
                                for i, picker in ipairs(library.RainbowRegistry.pickers) do
                                    if picker.instance == colorpicker then
                                        pickerIndex = i
                                        break
                                    end
                                end
                                
                                if pickerIndex then
                                    table.remove(library.RainbowRegistry.pickers, pickerIndex)
                                    if #library.RainbowRegistry.pickers == 0 and library.RainbowRegistry.connection then
                                        library.RainbowRegistry.connection:Disconnect()
                                        library.RainbowRegistry.connection = nil
                                    end
                                end
                            end
                        end)

                        Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
                        return colorpicker
                    end

        function tabcontent:Label(text)
            local Label = Instance.new("TextLabel")
            local LabelCorner = Instance.new("UICorner")
            local LabelTitle = Instance.new("TextLabel")

            Label.Name = "Label"
            Label.Parent = Tab
            Label.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
            Label.Size = UDim2.new(0, 363, 0, 42)
            Label.Font = Enum.Font.SourceSans
            Label.Text = ""
            Label.TextColor3 = Color3.fromRGB(0, 0, 0)
            Label.TextSize = 14.000

            LabelCorner.CornerRadius = UDim.new(0, 5)
            LabelCorner.Name = "LabelCorner"
            LabelCorner.Parent = Label

            LabelTitle.Name = "LabelTitle"
            LabelTitle.Parent = Label
            LabelTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            LabelTitle.BackgroundTransparency = 1.000
            LabelTitle.Position = UDim2.new(0.0358126722, 0, 0, 0)
            LabelTitle.Size = UDim2.new(0, 187, 0, 42)
            LabelTitle.Font = Enum.Font.GothamBlack
            LabelTitle.Text = text
            LabelTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
            LabelTitle.TextSize = 15
            LabelTitle.TextXAlignment = Enum.TextXAlignment.Left

            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
        end

        function tabcontent:Textbox(text, disappear, callback, flag, options)
            local flag = flag or text
            local options = options or {}
            local placeholder = options.placeholder or ""
            local maxChars = options.maxChars
            local filterFunc = options.filter
            local autoFocus = options.autoFocus
            local selectAllOnFocus = options.selectAll
            local Textbox = Instance.new("Frame")
            local TextboxCorner = Instance.new("UICorner")
            local TextboxTitle = Instance.new("TextLabel")
            local TextboxFrame = Instance.new("Frame")
            local TextboxFrameCorner = Instance.new("UICorner")
            local TextBox = Instance.new("TextBox")
            Textbox.Name = "Textbox"
            Textbox.Parent = Tab
            Textbox.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
            Textbox.ClipsDescendants = true
            Textbox.Position = UDim2.new(0, 0, 0, 0)
            Textbox.Size = UDim2.new(0, 363, 0, 42)
            TextboxCorner.CornerRadius = UDim.new(0, 5)
            TextboxCorner.Name = "TextboxCorner"
            TextboxCorner.Parent = Textbox
            TextboxTitle.Name = "TextboxTitle"
            TextboxTitle.Parent = Textbox
            TextboxTitle.BackgroundTransparency = 1
            TextboxTitle.Position = UDim2.new(0.0358126722, 0, 0, 0)
            TextboxTitle.Size = UDim2.new(0, 187, 0, 42)
            TextboxTitle.Font = Enum.Font.SourceSans
            TextboxTitle.Text = text
            TextboxTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
            TextboxTitle.TextSize = 18
            TextboxTitle.TextXAlignment = Enum.TextXAlignment.Left
            TextboxFrame.Name = "TextboxFrame"
            TextboxFrame.Parent = Textbox
            TextboxFrame.BackgroundColor3 = Color3.fromRGB(37, 37, 37)
            TextboxFrame.Position = UDim2.new(0.686, 0, 0.214285716, 0)
            TextboxFrame.Size = UDim2.new(0, 100, 0, 23)
            TextboxFrame.ZIndex = 2
            TextboxFrameCorner.CornerRadius = UDim.new(0, 5)
            TextboxFrameCorner.Name = "TextboxFrameCorner"
            TextboxFrameCorner.Parent = TextboxFrame
            TextBox.Name = "TextBox"
            TextBox.Parent = TextboxFrame
            TextBox.BackgroundTransparency = 1
            TextBox.Size = UDim2.new(1, 0, 1, 0)
            TextBox.ZIndex = 3
            TextBox.Font = Enum.Font.Gotham
            TextBox.Text = ""
            TextBox.PlaceholderText = placeholder
            TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
            TextBox.TextSize = 14
            TextBox.ClearTextOnFocus = false
            local textbox = {
                value = "",
                set = function(self, value)
                    self.value = value or ""
                    TextBox.Text = self.value
                    pcall(callback, self.value)
                    return self
                end,
                clear = function(self)
                    return self:set("")
                end,
                getValue = function(self)
                    return self.value
                end,
                setPlaceholder = function(self, placeholderText)
                    TextBox.PlaceholderText = placeholderText or ""
                    return self
                end
            }
            if not library.flags then library.flags = {} end
            library.flags[flag] = textbox

            library.Conn[#library.Conn + 1] = TextBox:GetPropertyChangedSignal("Text"):Connect(function()
                if maxChars and #TextBox.Text > maxChars then
                    TextBox.Text = string.sub(TextBox.Text, 1, maxChars)
                    return
                end
                
                if filterFunc then
                    local filtered = filterFunc(TextBox.Text)
                    if filtered ~= TextBox.Text then
                        TextBox.Text = filtered
                        return
                    end
                end
                
                textbox.value = TextBox.Text
            end)

            library.Conn[#library.Conn + 1] = TextBox.Focused:Connect(function()
                tweensv:Create(TextboxFrame, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(46, 46, 46)}):Play()
                
                if selectAllOnFocus then
                    TextBox.SelectionStart = 0
                    TextBox.CursorPosition = #TextBox.Text + 1
                end
            end)

            library.Conn[#library.Conn + 1] = TextBox.FocusLost:Connect(function(enterPressed)
                tweensv:Create(TextboxFrame, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(37, 37, 37)}):Play()
                
                if enterPressed and #TextBox.Text > 0 then
                    pcall(callback, TextBox.Text)
                    if disappear then
                        TextBox.Text = ""
                        textbox.value = ""
                    end
                end
            end)

            library.Conn[#library.Conn + 1] = TextboxFrame.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    TextBox:CaptureFocus()
                end
            end)
            
            library.Conn[#library.Conn + 1] = TextboxFrame.MouseEnter:Connect(function()
                if not TextBox:IsFocused() then
                    tweensv:Create(TextboxFrame, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(42, 42, 42)}):Play()
                end
            end)

            library.Conn[#library.Conn + 1] = TextboxFrame.MouseLeave:Connect(function()
                if not TextBox:IsFocused() then
                    tweensv:Create(TextboxFrame, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(37, 37, 37)}):Play()
                end
            end)
            
            if autoFocus then
                task.defer(function()
                    TextBox:CaptureFocus()
                end)
            end
            
            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
            return textbox
        end

        function tabcontent:Bind(text, keypreset, callback, flag)
            local flag = flag or text
            local binding = false
            local Key = keypreset.Name
            local Bind = Instance.new("TextButton")
            local BindCorner = Instance.new("UICorner")
            local BindTitle = Instance.new("TextLabel")
            local BindText = Instance.new("TextLabel")

            Bind.Name = "Bind"
            Bind.Parent = Tab
            Bind.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
            Bind.Size = UDim2.new(0, 363, 0, 42)
            Bind.AutoButtonColor = false
            Bind.Font = Enum.Font.SourceSans
            Bind.Text = ""
            Bind.TextColor3 = Color3.fromRGB(0, 0, 0)
            Bind.TextSize = 14.000

            BindCorner.CornerRadius = UDim.new(0, 5)
            BindCorner.Name = "BindCorner"
            BindCorner.Parent = Bind

            BindTitle.Name = "BindTitle"
            BindTitle.Parent = Bind
            BindTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            BindTitle.BackgroundTransparency = 1.000
            BindTitle.Position = UDim2.new(0.0358126722, 0, 0, 0)
            BindTitle.Size = UDim2.new(0, 187, 0, 42)
            BindTitle.Font = Enum.Font.Gotham
            BindTitle.Text = text
            BindTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
            BindTitle.TextSize = 14.000
            BindTitle.TextXAlignment = Enum.TextXAlignment.Left

            BindText.Name = "BindText"
            BindText.Parent = Bind
            BindText.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            BindText.BackgroundTransparency = 1.000
            BindText.Position = UDim2.new(0.0358126722, 0, 0, 0)
            BindText.Size = UDim2.new(0, 337, 0, 42)
            BindText.Font = Enum.Font.Gotham
            BindText.Text = Key
            BindText.TextColor3 = Color3.fromRGB(255, 255, 255)
            BindText.TextSize = 14.000
            BindText.TextXAlignment = Enum.TextXAlignment.Right
            
            local keybind = {
                value = keypreset,
                keyName = Key,
                set = function(self, key)
                    if typeof(key) == "string" then
                        local success, keyEnum = pcall(function()
                            return Enum.KeyCode[key]
                        end)
                        if success and keyEnum then
                            self.value = keyEnum
                            self.keyName = key
                            Key = key
                            BindText.Text = key
                        end
                    elseif typeof(key) == "EnumItem" and key.EnumType == Enum.KeyCode then
                        self.value = key
                        self.keyName = key.Name
                        Key = key.Name
                        BindText.Text = key.Name
                    end
                    return self
                end,
                getValue = function(self)
                    return self.value
                end
            }
            
            if not library.flags then library.flags = {} end
            library.flags[flag] = keybind

            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)

            library.Conn[#library.Conn + 1] = Bind.MouseButton1Click:Connect(function()
                BindText.Text = "..."
                binding = true
                
                local inputwait = uis.InputBegan:wait()
                if inputwait.UserInputType == Enum.UserInputType.Keyboard and inputwait.KeyCode.Name ~= "Unknown" then
                    Key = inputwait.KeyCode.Name
                    keybind.value = inputwait.KeyCode
                    keybind.keyName = inputwait.KeyCode.Name
                    BindText.Text = inputwait.KeyCode.Name
                end
                binding = false
            end)

            library.Conn[#library.Conn + 1] = uis.InputBegan:Connect(function(input, gameProcessed)
                if not binding and not gameProcessed and input.UserInputType == Enum.UserInputType.Keyboard then
                    if input.KeyCode.Name == Key then
                        pcall(callback, Key)
                    end
                end
            end)
            
            library.Conn[#library.Conn + 1] = Bind.MouseEnter:Connect(function()
                tweensv:Create(Bind, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(38, 38, 38)}):Play()
            end)
            
            library.Conn[#library.Conn + 1] = Bind.MouseLeave:Connect(function()
                tweensv:Create(Bind, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(34, 34, 34)}):Play()
            end)
            
            return keybind
        end
        return tabcontent
    end
    return tabhold
end
----------------------------------------------------------------// CONFIG SYSTEM //----------------------------------------------------------------
function library:ConfigSystem(tab, name)
    local dir = library.Folder or "Dendrite.cc"

    if not isfolder(dir) then
        makefolder(dir)
    end
    
    local cfg = {
        list = {},
        pick = nil,
        auto = nil
    }
    
    library.flags = library.flags or {}
    
    local function sync()
        table.clear(cfg.list)
        local ok, files = pcall(listfiles, dir)
        if not ok then return {} end
        
        for _, file in ipairs(files) do
            local name = file:match("[^/\\]+$")
            local item = name and name:match("^(.+)%.json$")
            if item then
                table.insert(cfg.list, item)
                local got, content = pcall(readfile, file)
                if got then
                    local valid, data = pcall(game:GetService("HttpService").JSONDecode, game:GetService("HttpService"), content)
                    if valid and type(data) == "table" and type(data.metadata) == "table" and data.metadata.autoLoad then
                        cfg.auto = item
                    end
                end
            end
        end
        return cfg.list
    end
    
    cfg.sync = sync

    local function pack(val)
        local typ = typeof(val)
        if typ == "Color3" then
            return {__type="Color3", r=val.R, g=val.G, b=val.B}
        elseif typ == "EnumItem" then
            return {__type="EnumItem", enumType=tostring(val.EnumType), value=val.Name}
        elseif typ == "table" then
            -- Handle KeybindT objects specifically
            if type(val.set) == "function" and val.keyCode and val.mode and (val.value ~= nil or val.keyState ~= nil) then
                return {
                    __type = "KeybindT",
                    toggleState = val.value,
                    keyCode = typeof(val.keyCode) == "EnumItem" and val.keyCode.Name or "Unknown",
                    mode = val.mode,
                    keyState = val.keyState
                }
            end
            
            if type(val.getValue) == "function" then
                local value = val:getValue()
                if type(value) == "number" then
                    return {__type="Slider", value=value}
                elseif typeof(value) == "EnumItem" and value.EnumType == Enum.KeyCode then
                    return {__type="Bind", key=value.Name}
                elseif value ~= nil then
                    return value
                end
            end
            if val ~= nil and type(val.value) ~= "nil" and type(val.set) == "function" then
                if type(val.value) == "number" then
                    return {__type="Slider", value=val.value}
                elseif typeof(val.value) == "EnumItem" and val.value.EnumType == Enum.KeyCode then
                    return {__type="Bind", key=val.value.Name}
                elseif type(val.value) == "string" or type(val.value) == "boolean" then
                    return val.value
                elseif typeof(val.value) == "Color3" then
                    local t = {__type="Color3", r=val.value.R, g=val.value.G, b=val.value.B}
                    if val.rainbow ~= nil then t.__rainbow = val.rainbow end
                    return t
                end
            end
            if (val.keyCode or val.keyName) and type(val.set) == "function" then
                local keyData = {
                    __type = "Keybind",
                    keyName = val.keyName or (val.keyCode and val.keyCode.Name) or "Unknown",
                    keyCode = val.keyCode and {__type="EnumItem", enumType="Enum.KeyCode", value=val.keyCode.Name} or nil
                }
                if val.mode then keyData.mode = val.mode end
                if type(val.value) == "boolean" then keyData.toggleState = val.value end
                if val.keyState ~= nil then keyData.keyState = val.keyState end
                return keyData
            end
            if type(val.set) == "function" and val.options and val.value then
                return {__type="Dropdown", selected=val.value, options=val.options}
            end
            local out = {}
            for k, v in pairs(val) do
                if type(v) ~= "function" then
                    out[k] = pack(v)
                end
            end
            return out
        end
        return val
    end

    local function unpack(val)
        if type(val) ~= "table" then return val end
        if val.__type == "Color3" then
            local color = Color3.new(val.r, val.g, val.b)
            return val.__rainbow and {value=color, rainbow=val.__rainbow} or color
        elseif val.__type == "EnumItem" then
            local enumName = val.enumType:match("Enum%.([^%s]+)$") or val.enumType:match("Enum%.([^%s]+)")
            return enumName and Enum[enumName] and Enum[enumName][val.value]
        elseif val.__type == "KeybindT" then
            return {
                value = val.toggleState,
                keyCode = Enum.KeyCode[val.keyCode] or Enum.KeyCode.Unknown,
                mode = val.mode,
                keyState = val.keyState
            }
        elseif val.__type == "Keybind" then
            local keyEnum
            if val.keyCode and val.keyCode.__type == "EnumItem" then
                keyEnum = Enum.KeyCode[val.keyCode.value]
            else
                keyEnum = Enum.KeyCode[val.keyName]
            end
            local result = {
                keyName = val.keyName,
                keyCode = keyEnum or Enum.KeyCode.Unknown
            }
            if val.mode then result.mode = val.mode end
            if val.toggleState ~= nil then result.value = val.toggleState end
            if val.keyState ~= nil then result.keyState = val.keyState end
            return result
        elseif val.__type == "Slider" then
            return val.value
        elseif val.__type == "Dropdown" then
            return val.selected
        elseif val.__type == "Bind" then
            return Enum.KeyCode[val.key] or Enum.KeyCode.Unknown
        end
        local out = {}
        for k, v in pairs(val) do out[k] = unpack(v) end
        return out
    end
    
    sync()
    
    tab:Label("CONFIGURATION SYSTEM")
    
    local nameBox = tab:Textbox("Config Name", false, function(text)
        if library.flags["config_name_input"] then
            library.flags["config_name_input"].value = text
        end
    end, "config_name_input")
    
    local menu = tab:NewDropdown("Select Config", cfg.list, function(item)
        cfg.pick = item
        library:Notification("Config Selected", "Selected config: " .. item, "OK")
    end, false, "config_selector")
    
    local silentAutoLoadUpdate = false
    local autoLoad = tab:Toggle("Auto Load Selected Config", false, function(on)
        if silentAutoLoadUpdate then silentAutoLoadUpdate = false return end
        if not cfg.pick then return library:Notification("Error", "No config selected.", "OK", "rbxassetid://109809645126775") end
        
        local path = dir.."/"..cfg.pick..".json"
        local ok, raw = pcall(readfile, path)
        if not ok then
            silentAutoLoadUpdate = true
            autoLoad:set(false)
            return library:Notification("Error", "Failed to read config file.", "OK", "rbxassetid://109809645126775")
        end
        
        local valid, data = pcall(game:GetService("HttpService").JSONDecode, game:GetService("HttpService"), raw)
        if not valid or type(data) ~= "table" then
            silentAutoLoadUpdate = true
            autoLoad:set(false)
            return library:Notification("Error", "Invalid config format.", "OK", "rbxassetid://109809645126775")
        end
        
        data.metadata = data.metadata or {}
        data.metadata.autoLoad = on
        data.metadata.lastModified = os.time()
        
        if on then
            for _, name in ipairs(cfg.list) do
                if name ~= cfg.pick then
                    local other = dir.."/"..name..".json"
                    local has, file = pcall(readfile, other)
                    if has then
                        local good, info = pcall(game:GetService("HttpService").JSONDecode, game:GetService("HttpService"), file)
                        if good and info.metadata then
                            info.metadata.autoLoad = false
                            pcall(writefile, other, game:GetService("HttpService"):JSONEncode(info))
                        end
                    end
                end
            end
            
            library:Notification("Auto-Load Enabled", "Config '" .. cfg.pick .. "' will be automatically loaded on startup.", "OK")
        else
            library:Notification("Auto-Load Disabled", "Config '" .. cfg.pick .. "' will no longer auto-load.", "OK")
        end
        
        local saved = pcall(writefile, path, game:GetService("HttpService"):JSONEncode(data))
        if not saved then
            silentAutoLoadUpdate = true
            autoLoad:set(not on)
            return library:Notification("Error", "Failed to update config file.", "OK", "rbxassetid://109809645126775")
        end
        
        if on then
            cfg.auto = cfg.pick
        else
            if cfg.auto == cfg.pick then cfg.auto = nil end
        end
    end, "config_autoload")
    
    tab:Button("Create Config", function()
        local name = library.flags["config_name_input"] and library.flags["config_name_input"].value or ""
        if name == "" then return library:Notification("Error", "Please enter a config name.", "OK", "rbxassetid://109809645126775") end
        if not name:match("^[%w_]+$") then return library:Notification("Error", "Config name can only contain letters, numbers, and underscores.", "OK", "rbxassetid://109809645126775") end
        
        for _, item in ipairs(cfg.list) do
            if item:lower() == name:lower() then
                return library:Notification("Error", "Config already exists.", "OK", "rbxassetid://109809645126775")
            end
        end
        
        local data = {
            metadata = {
                createdAt = os.time(),
                lastModified = os.time(),
                autoLoad = false,
                name = name
            },
            values = {}
        }
        
        local count = 0
        for flag, elem in pairs(library.flags) do
            if elem ~= nil then
                if type(elem) == "table" then
                    if not flag:match("_rainbow$") then
                        data.values[flag] = pack(elem)
                        count = count + 1
                    end
                    if type(elem.rainbow) == "boolean" then
                        data.values[flag.."_rainbow"] = elem.rainbow
                    end
                else
                    data.values[flag] = elem
                    count = count + 1
                end
            end
        end
        
        local path = dir.."/"..name..".json"
        local ok = pcall(writefile, path, game:GetService("HttpService"):JSONEncode(data))
        if not ok then return library:Notification("Error", "Failed to create config file.", "OK", "rbxassetid://109809645126775") end
        
        library:Notification("Config Created", "Successfully created config '" .. name .. "' with " .. count .. " values.", "OK")
        
        sync()
        menu:Refresh(cfg.list)
        menu:set(name)
        cfg.pick = name
        nameBox:set("")
    end)

    tab:Button("Save/Overwrite Config", function()
        if not cfg.pick then return library:Notification("Error", "No config selected.", "OK", "rbxassetid://109809645126775") end
        
        local path = dir.."/"..cfg.pick..".json"
        local ok, raw = pcall(readfile, path)
        if not ok then return library:Notification("Error", "Config does not exist.", "OK", "rbxassetid://109809645126775") end
        
        local valid, data = pcall(game:GetService("HttpService").JSONDecode, game:GetService("HttpService"), raw)
        if not valid or type(data) ~= "table" or type(data.values) ~= "table" then
            return library:Notification("Error", "Invalid config format.", "OK", "rbxassetid://109809645126775")
        end
        
        data.metadata = data.metadata or {}
        data.metadata.lastModified = os.time()
        data.values = {}
        
        local count = 0
        for flag, elem in pairs(library.flags) do
            if elem ~= nil then
                if type(elem) == "table" then
                    if not flag:match("_rainbow$") then
                        data.values[flag] = pack(elem)
                        count = count + 1
                    end
                    if type(elem.rainbow) == "boolean" then
                        data.values[flag.."_rainbow"] = elem.rainbow
                    end
                else
                    data.values[flag] = elem
                    count = count + 1
                end
            end
        end
        
        ok = pcall(writefile, path, game:GetService("HttpService"):JSONEncode(data))
        if not ok then return library:Notification("Error", "Failed to save config file.", "OK", "rbxassetid://109809645126775") end
        
        library:Notification("Config Saved", "Successfully saved " .. count .. " values to config '" .. cfg.pick .. "'.", "OK")
    end)

    tab:Button("Load Config", function()
        if not cfg.pick then return library:Notification("Error", "No config selected.", "OK", "rbxassetid://109809645126775") end
        local path = dir.."/"..cfg.pick..".json"
        local ok, raw = pcall(readfile, path)
        if not ok then return library:Notification("Error", "Config does not exist.", "OK", "rbxassetid://109809645126775") end

        local valid, data = pcall(game:GetService("HttpService").JSONDecode, game:GetService("HttpService"), raw)
        if not valid or type(data.values) ~= "table" then
            return library:Notification("Error", "Invalid config format.", "OK", "rbxassetid://109809645126775")
        end
        
        local loaded = 0
        for flag, val in pairs(data.values) do
            if flag:match("_rainbow$") or flag == "config_autoload" then continue end

            if library.flags[flag] then
                local element = library.flags[flag]
                local success, result = pcall(function()
                    if type(element) == "table" and type(element.set) == "function" then
                        -- Handle KeybindT objects
                        if type(val) == "table" and val.__type == "KeybindT" then
                            element:set({
                                value = val.toggleState,
                                keyCode = Enum.KeyCode[val.keyCode] or Enum.KeyCode.Unknown,
                                mode = val.mode,
                                keyState = val.keyState
                            })
                        -- Existing handlers for other object types
                        elseif type(val) == "table" and val.__type == "Color3" then
                            element:set(Color3.new(val.r, val.g, val.b))
                        elseif type(val) == "table" and val.__type == "Keybind" then
                            local keyEnum
                            if val.keyCode and val.keyCode.__type == "EnumItem" then
                                keyEnum = Enum.KeyCode[val.keyCode.value]
                            else
                                keyEnum = Enum.KeyCode[val.keyName]
                            end
                            if keyEnum then
                                local data = {keyCode = keyEnum}
                                if val.mode then data.mode = val.mode end
                                if val.toggleState ~= nil then data.value = val.toggleState end
                                if val.keyState ~= nil then data.keyState = val.keyState end
                                element:set(data)
                            end
                        elseif type(val) == "table" and val.__type == "Slider" then
                            element:set(val.value)
                        elseif type(val) == "table" and val.__type == "Bind" then
                            element:set(Enum.KeyCode[val.key] or Enum.KeyCode.Unknown)
                        elseif type(val) == "table" and val.__type == "Dropdown" then
                            element:set(val.selected)
                        elseif type(val) == "table" and (val.selected or val.options) then
                            element:set(val.selected or val)
                        elseif type(val) == "number" or type(val) == "string" or type(val) == "boolean" then
                            element:set(val)
                        else
                            element:set(val)
                        end
                    else
                        library.flags[flag] = val
                    end
                end)
                if success then loaded = loaded + 1 end
            end
        end
        
        for flag, val in pairs(data.values) do
            if not flag:match("_rainbow$") then continue end
            local baseFlagName = flag:gsub("_rainbow$", "")
            if library.flags[baseFlagName] and type(library.flags[baseFlagName].setRainbow) == "function" then
                pcall(library.flags[baseFlagName].setRainbow, library.flags[baseFlagName], val)
            end
        end
        
        library:Notification("Config Loaded", "Successfully loaded " .. loaded .. " values from config '" .. cfg.pick .. "'.", "OK")
    end)
    
    tab:Button("Delete Config", function()
        if not cfg.pick then return library:Notification("Error", "No config selected.", "OK", "rbxassetid://109809645126775") end
        
        local path = dir.."/"..cfg.pick..".json"
        local ok = pcall(delfile, path)
        if not ok then return library:Notification("Error", "Failed to delete config file.", "OK", "rbxassetid://109809645126775") end

        library:Notification("Config Deleted", "Successfully deleted config '" .. cfg.pick .. "'.", "OK")

        if cfg.auto == cfg.pick then
            cfg.auto = nil
            silentAutoLoadUpdate = true
            autoLoad:set(false)
        end
        
        cfg.pick = nil
        sync()
        if menu and type(menu.Refresh) == "function" then
            menu:Refresh(cfg.list)
            menu:set(nil)
        end
    end)
    
    tab:Button("Refresh Config List", function()
        table.clear(cfg.list)
        local items = sync()
        if menu then
            if type(menu.Refresh) == "function" then
                menu:Refresh(items)
                if cfg.pick and not table.find(items, cfg.pick) then
                    cfg.pick = nil
                end
            else
                menu = tab:NewDropdown("Select Config", items, function(item)
                    cfg.pick = item
                    library:Notification("Config Selected", "Selected config: " .. item, "OK")
                end, false, "config_selector")
            end
        else
            menu = tab:NewDropdown("Select Config", items, function(item)
                cfg.pick = item
                library:Notification("Config Selected", "Selected config: " .. item, "OK")
            end, false, "config_selector")
        end
        
        library:Notification("Config List Refreshed", "Found " .. #items .. " configs.", "OK")
    end)
    
    task.spawn(function()
        local success, err = pcall(function()
            task.wait(0.5)
            if not cfg.auto then return end
            local path = dir.."/"..cfg.auto..".json"
            local ok, raw = pcall(readfile, path)
            if not ok then return end

            local valid, data = pcall(game:GetService("HttpService").JSONDecode, game:GetService("HttpService"), raw)
            if not valid or type(data.values) ~= "table" then return end

            local loaded = 0
            cfg.pick = cfg.auto
            if menu and type(menu.set) == "function" then
                menu:set(cfg.auto)
            end

            for flag, val in pairs(data.values) do
                if flag:match("_rainbow$") or flag == "config_autoload" then continue end

                if library.flags[flag] then
                    local element = library.flags[flag]
                    local success, result = pcall(function()
                        if type(element) == "table" and type(element.set) == "function" then
                            -- Handle KeybindT objects
                            if type(val) == "table" and val.__type == "KeybindT" then
                                element:set({
                                    value = val.toggleState,
                                    keyCode = Enum.KeyCode[val.keyCode] or Enum.KeyCode.Unknown,
                                    mode = val.mode,
                                    keyState = val.keyState
                                })
                            -- Existing handlers for other object types
                            elseif type(val) == "table" and val.__type == "Color3" then
                                element:set(Color3.new(val.r, val.g, val.b))
                            elseif type(val) == "table" and val.__type == "Keybind" then
                                local keyEnum
                                if val.keyCode and val.keyCode.__type == "EnumItem" then
                                    keyEnum = Enum.KeyCode[val.keyCode.value]
                                else
                                    keyEnum = Enum.KeyCode[val.keyName]
                                end

                                if keyEnum then
                                    local data = {keyCode = keyEnum}
                                    if val.mode then data.mode = val.mode end
                                    if val.toggleState ~= nil then data.value = val.toggleState end
                                    if val.keyState ~= nil then data.keyState = val.keyState end
                                    element:set(data)
                                end
                            elseif type(val) == "table" and val.__type == "Slider" then
                                element:set(val.value)
                            elseif type(val) == "table" and val.__type == "Dropdown" then
                                element:set(val.selected)
                            elseif type(val) == "table" and (val.selected or val.options) then
                                element:set(val.selected or val)
                            elseif type(val) == "number" or type(val) == "string" or type(val) == "boolean" then
                                element:set(val)
                            else
                                element:set(val)
                            end
                        else
                            library.flags[flag] = val
                        end
                    end)
                    if success then loaded = loaded + 1 end
                end
            end

            for flag, val in pairs(data.values) do
                if not flag:match("_rainbow$") then continue end
                local baseFlagName = flag:gsub("_rainbow$", "")
                if library.flags[baseFlagName] and type(library.flags[baseFlagName].setRainbow) == "function" then
                    pcall(library.flags[baseFlagName].setRainbow, library.flags[baseFlagName], val)
                end
            end

            silentAutoLoadUpdate = true
            autoLoad:set(true)

            library:Notification("Config Auto-Loaded", "Successfully loaded " .. loaded .. " values from config '" .. cfg.auto .. "'.", "OK")
        end)
        if not success then
            library:Notification("Auto-Load Error", tostring(err), "OK", "rbxassetid://109809645126775")
        end
    end)
    return cfg
end
return library
